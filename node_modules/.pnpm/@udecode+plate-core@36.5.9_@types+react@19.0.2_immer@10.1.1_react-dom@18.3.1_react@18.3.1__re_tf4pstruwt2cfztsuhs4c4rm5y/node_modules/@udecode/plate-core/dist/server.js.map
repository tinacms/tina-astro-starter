{"version":3,"sources":["../src/server.ts","../src/server/createPlateEditor.ts","../src/shared/utils/createPlugins.tsx","../src/shared/utils/overridePluginsByKey.ts","../src/shared/transforms/resetEditorChildren.ts","../src/shared/transforms/resetEditor.ts","../src/shared/transforms/toggleNodeType.ts","../src/shared/constants/ELEMENT_DEFAULT.ts","../src/shared/utils/getPluginsByKey.ts","../src/shared/utils/getPlugin.ts","../src/shared/utils/getPluginType.ts","../src/server/setPlatePlugins.ts","../src/shared/plugins/createDeserializeAstPlugin.ts","../src/shared/utils/createPluginFactory.ts","../src/shared/plugins/createEditorProtocolPlugin.ts","../src/shared/plugins/createHistoryPlugin.ts","../src/shared/plugins/createInlineVoidPlugin.ts","../src/shared/utils/getInjectedPlugins.ts","../src/shared/utils/pipeInsertDataQuery.ts","../src/shared/utils/pipeInsertFragment.ts","../src/shared/utils/pipeTransformData.ts","../src/shared/utils/pipeTransformFragment.ts","../src/shared/plugins/createInsertDataPlugin.ts","../src/shared/plugins/createLengthPlugin.ts","../src/shared/utils/applyDeepToNodes.ts","../src/shared/utils/flattenDeepPlugins.ts","../src/shared/utils/mergeDeepPlugins.ts","../src/shared/utils/setDefaultPlugin.ts","../src/shared/utils/getKeysByTypes.ts","../src/shared/utils/getKeyByType.ts","../src/shared/utils/getPluginInjectProps.ts","../src/shared/utils/getPluginOptions.ts","../src/shared/utils/getPluginTypes.ts","../src/shared/utils/getPlugins.ts","../src/shared/utils/getRenderNodeProps.ts","../src/shared/utils/misc/getSlateClass.ts","../src/shared/utils/mapInjectPropsToPlugin.ts","../src/shared/utils/mergeDeepToNodes.ts","../src/shared/utils/mockPlugin.ts","../src/shared/utils/normalizeDescendantsToDocumentFragment.ts","../src/shared/utils/normalizeInitialValue.ts","../src/shared/utils/pipeDecorate.ts","../src/shared/utils/pipeHandler.ts","../src/shared/utils/pluginInjectProps.ts","../src/shared/utils/pipeInjectProps.tsx","../src/shared/utils/pipeOnChange.ts","../src/shared/utils/shared-hotkeys.ts","../src/shared/utils/withHOC.tsx","../src/shared/plugins/createNodeFactoryPlugin.ts","../src/shared/plugins/createPrevSelectionPlugin.ts","../src/shared/plugins/event-editor/constants.ts","../src/shared/libs/nanoid.ts","../src/shared/libs/zustand.ts","../src/shared/plugins/event-editor/eventEditorStore.ts","../src/shared/plugins/event-editor/createEventEditorPlugin.ts","../src/shared/plugins/event-editor/getEventPlateId.ts","../src/shared/plugins/html-deserializer/constants.ts","../src/shared/plugins/html-deserializer/utils/collapse-white-space/collapseString.ts","../src/shared/plugins/html-deserializer/utils/inlineTagNames.ts","../src/shared/plugins/html-deserializer/utils/isHtmlElement.ts","../src/shared/plugins/html-deserializer/utils/isHtmlInlineElement.ts","../src/shared/plugins/html-deserializer/utils/isHtmlText.ts","../src/shared/plugins/html-deserializer/utils/isHtmlBlockElement.ts","../src/shared/plugins/html-deserializer/utils/collapse-white-space/isLastNonEmptyTextOfInlineFormattingContext.ts","../src/shared/plugins/html-deserializer/utils/collapse-white-space/stateTransforms.ts","../src/shared/plugins/html-deserializer/utils/collapse-white-space/collapseWhiteSpaceText.ts","../src/shared/plugins/html-deserializer/utils/collapse-white-space/collapseWhiteSpaceNode.ts","../src/shared/plugins/html-deserializer/utils/collapse-white-space/collapseWhiteSpaceChildren.ts","../src/shared/plugins/html-deserializer/utils/collapse-white-space/inferWhiteSpaceRule.ts","../src/shared/plugins/html-deserializer/utils/collapse-white-space/collapseWhiteSpaceElement.ts","../src/shared/plugins/html-deserializer/utils/collapse-white-space/collapseWhiteSpace.ts","../src/shared/plugins/html-deserializer/utils/htmlBodyToFragment.ts","../src/shared/plugins/html-deserializer/utils/deserializeHtmlNodeChildren.ts","../src/shared/plugins/html-deserializer/utils/htmlBrToNewLine.ts","../src/shared/plugins/html-deserializer/utils/htmlElementToElement.ts","../src/shared/plugins/html-deserializer/utils/pluginDeserializeHtml.ts","../src/shared/plugins/html-deserializer/utils/pipeDeserializeHtmlElement.ts","../src/shared/plugins/html-deserializer/utils/htmlElementToLeaf.ts","../src/shared/plugins/html-deserializer/utils/pipeDeserializeHtmlLeaf.ts","../src/shared/plugins/html-deserializer/utils/htmlTextNodeToString.ts","../src/shared/plugins/html-deserializer/utils/deserializeHtmlNode.ts","../src/shared/plugins/html-deserializer/utils/deserializeHtmlElement.ts","../src/shared/plugins/html-deserializer/utils/htmlStringToDOMNode.ts","../src/shared/plugins/html-deserializer/utils/deserializeHtml.ts","../src/shared/plugins/html-deserializer/utils/parseHtmlDocument.ts","../src/shared/plugins/html-deserializer/createDeserializeHtmlPlugin.ts","../src/shared/plugins/html-deserializer/utils/traverseHtmlNode.ts","../src/shared/plugins/html-deserializer/utils/traverseHtmlElements.ts","../src/shared/plugins/html-deserializer/utils/cleanHtmlBrElements.ts","../src/shared/plugins/html-deserializer/utils/cleanHtmlCrLf.ts","../src/shared/plugins/html-deserializer/utils/cleanHtmlEmptyElements.ts","../src/shared/plugins/html-deserializer/utils/replaceTagName.ts","../src/shared/plugins/html-deserializer/utils/cleanHtmlFontElements.ts","../src/shared/plugins/html-deserializer/utils/isHtmlFragmentHref.ts","../src/shared/plugins/html-deserializer/utils/unwrapHtmlElement.ts","../src/shared/plugins/html-deserializer/utils/cleanHtmlLinkElements.ts","../src/shared/plugins/html-deserializer/utils/traverseHtmlTexts.ts","../src/shared/plugins/html-deserializer/utils/cleanHtmlTextNodes.ts","../src/shared/plugins/html-deserializer/utils/isHtmlTable.ts","../src/shared/plugins/html-deserializer/utils/copyBlockMarksToSpanChild.ts","../src/shared/plugins/html-deserializer/utils/findHtmlElement.ts","../src/shared/plugins/html-deserializer/utils/getHtmlComments.ts","../src/shared/plugins/html-deserializer/utils/isHtmlComment.ts","../src/shared/plugins/html-deserializer/utils/isOlSymbol.ts","../src/shared/plugins/html-deserializer/utils/parseHtmlElement.ts","../src/shared/plugins/html-deserializer/utils/postCleanHtml.ts","../src/shared/plugins/html-deserializer/utils/removeHtmlSurroundings.ts","../src/shared/plugins/html-deserializer/utils/preCleanHtml.ts","../src/shared/plugins/html-deserializer/utils/traverseHtmlComments.ts","../src/shared/plugins/html-deserializer/utils/removeHtmlNodesBetweenComments.ts","../src/server/createReactPlugin.ts","../src/server/withPlate.ts","../src/shared/components/DefaultLeaf.tsx","../src/shared/types/PlateStore.ts","../src/shared/types/misc/dom-attributes.ts"],"sourcesContent":["export * from './server/index';\n\nexport * from './shared/index';\n","import {\n  type TEditor,\n  type Value,\n  createTEditor,\n  normalizeEditor,\n} from '@udecode/slate';\n\nimport type { CreatePlateEditorOptions } from '../client/utils/createPlateEditor';\nimport type { PlateEditor } from '../shared/types/PlateEditor';\n\nimport { createPlugins } from '../shared/utils/createPlugins';\nimport { withPlate } from './withPlate';\n\n/**\n * Create a plate editor with:\n *\n * - `createTEditor` or custom `editor`\n * - `withPlate`\n * - Custom `components`\n */\nexport const createPlateEditor = <\n  V extends Value = Value,\n  E extends TEditor<V> = TEditor<V>,\n>({\n  components,\n  editor = createTEditor() as E,\n  normalizeInitialValue: shouldNormalizeInitialValue,\n  overrideByKey,\n  plugins = [],\n  ...withPlateOptions\n}: CreatePlateEditorOptions<V, E> = {}): E & PlateEditor<V> => {\n  plugins = createPlugins(plugins, {\n    components,\n    overrideByKey,\n  });\n\n  const e = withPlate<V>(editor, {\n    plugins,\n    ...withPlateOptions,\n  }) as E & PlateEditor<V>;\n\n  if (shouldNormalizeInitialValue) {\n    normalizeEditor(e, { force: true });\n  }\n\n  return e;\n};\n","import type { Value } from '@udecode/slate';\n\nimport cloneDeep from 'lodash/cloneDeep.js';\n\nimport type { OverrideByKey } from '../types/OverrideByKey';\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { PlatePlugin, PluginOptions } from '../types/plugin/PlatePlugin';\nimport type { PlatePluginComponent } from '../types/plugin/PlatePluginComponent';\n\nimport { overridePluginsByKey } from './overridePluginsByKey';\n\n/**\n * Creates a new array of plugins by overriding the plugins in the original\n * array. Components can be overridden by key using `components` in the second\n * param. Any other properties can be overridden by key using `overrideByKey` in\n * the second param.\n */\nexport const createPlugins = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  plugins: PlatePlugin[],\n  {\n    components,\n    overrideByKey,\n  }: {\n    /** Override plugin component by key. */\n    components?: Record<string, PlatePluginComponent>;\n\n    /** Override plugin by key. */\n    overrideByKey?: OverrideByKey;\n  } = {}\n): PlatePlugin<PluginOptions, V, E>[] => {\n  let allOverrideByKey: OverrideByKey = {};\n\n  if (overrideByKey) {\n    allOverrideByKey = cloneDeep(overrideByKey);\n  }\n  if (components) {\n    Object.keys(components).forEach((key) => {\n      if (!allOverrideByKey[key]) allOverrideByKey[key] = {};\n\n      allOverrideByKey[key].component = components[key];\n    });\n  }\n  if (Object.keys(allOverrideByKey).length > 0) {\n    return plugins.map((plugin) => {\n      return overridePluginsByKey(plugin as any, allOverrideByKey as any);\n    });\n  }\n\n  return plugins as PlatePlugin<PluginOptions, V, E>[];\n};\n","import type { Value } from '@udecode/slate';\n\nimport defaultsDeep from 'lodash/defaultsDeep.js';\n\nimport type { OverrideByKey } from '../types/OverrideByKey';\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { NoInfer } from '../types/misc/NoInfer';\nimport type { PlatePlugin, PluginOptions } from '../types/plugin/PlatePlugin';\n\n/**\n * Recursive deep merge of each plugin from `overrideByKey` into plugin with\n * same key (plugin > plugin.plugins).\n */\nexport const overridePluginsByKey = <\n  P = PluginOptions,\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  plugin: PlatePlugin<NoInfer<P>, V, E>,\n  overrideByKey: OverrideByKey<V, E> = {},\n  nested = false\n): PlatePlugin<NoInfer<P>, V, E> => {\n  if (overrideByKey[plugin.key]) {\n    const {\n      plugins: pluginOverridesPlugins,\n      then: pluginOverridesThen,\n      ...pluginOverrides\n    } = overrideByKey[plugin.key];\n\n    // override plugin\n    plugin = defaultsDeep(pluginOverrides, plugin);\n\n    if (!nested) {\n      // concat new pluginOverrides.plugins to plugin.plugins\n      pluginOverridesPlugins?.forEach((pOverrides) => {\n        if (!plugin.plugins) plugin.plugins = [];\n\n        const found = plugin.plugins.find((p) => p.key === pOverrides.key);\n\n        if (!found) plugin.plugins.push(pOverrides);\n      });\n    }\n  }\n  if (plugin.plugins) {\n    // override plugin.plugins\n    plugin.plugins = plugin.plugins.map((p) =>\n      overridePluginsByKey<{}, V, E>(p, overrideByKey, true)\n    );\n  }\n\n  const { then } = plugin;\n\n  if (then) {\n    if (plugin._thenReplaced === undefined) {\n      plugin._thenReplaced = 0;\n    }\n    // Limit the number of times that `then` can be replaced.\n    // otherwise we will accidentally create a stack overflow.\n    // There is probably a better solution for this.\n    if ((plugin._thenReplaced as number) < 3) {\n      // override plugin.then\n      plugin.then = (editor, p) => {\n        const pluginThen = { key: plugin.key, ...then(editor, p) };\n\n        return defaultsDeep(\n          overridePluginsByKey(pluginThen as any, overrideByKey),\n          pluginThen\n        );\n      };\n      (plugin._thenReplaced as number)++;\n    }\n  } else if (overrideByKey[plugin.key]?.then) {\n    // TODO: recursvie\n    plugin.then = overrideByKey[plugin.key].then as any;\n  }\n\n  return plugin;\n};\n","import type { EElement, Value } from '@udecode/slate';\n\nimport {\n  type ReplaceNodeChildrenOptions,\n  replaceNodeChildren,\n} from '@udecode/slate-utils';\n\nimport type { PlateEditor } from '../types/index';\n\n/** Replace editor children by default block. */\nexport const resetEditorChildren = <V extends Value>(\n  editor: PlateEditor<V>,\n  options?: Omit<ReplaceNodeChildrenOptions<EElement<V>, V>, 'at' | 'nodes'>\n) => {\n  replaceNodeChildren<EElement<V>>(editor, {\n    at: [],\n    nodes: editor.childrenFactory(),\n    ...options,\n  } as any);\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/index';\n\nimport { resetEditorChildren } from './resetEditorChildren';\n\nexport const resetEditor = <V extends Value>(editor: PlateEditor<V>) => {\n  resetEditorChildren(editor);\n\n  editor.history.undos = [];\n  editor.history.redos = [];\n  editor.operations = [];\n};\n","import {\n  type GetNodeEntriesOptions,\n  type Value,\n  setElements,\n  someNode,\n} from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\n\nimport { ELEMENT_DEFAULT } from '../constants/ELEMENT_DEFAULT';\nimport { getPluginType } from '../utils/getPluginType';\n\nexport interface ToggleNodeTypeOptions {\n  /**\n   * If there is no node type above the selection, set the selected node type to\n   * activeType.\n   */\n  activeType?: string;\n\n  /**\n   * If there is a node type above the selection, set the selected node type to\n   * inactiveType.\n   */\n  inactiveType?: string;\n}\n\n/**\n * Toggle the type of the selected node. Don't do anything if activeType ===\n * inactiveType.\n */\nexport const toggleNodeType = <V extends Value>(\n  editor: PlateEditor<V>,\n  options: ToggleNodeTypeOptions,\n  editorNodesOptions?: Omit<GetNodeEntriesOptions<V>, 'match'>\n) => {\n  const { activeType, inactiveType = getPluginType(editor, ELEMENT_DEFAULT) } =\n    options;\n\n  const at = editorNodesOptions?.at ?? editor.selection;\n\n  if (!activeType || !at) return;\n\n  const isActive = someNode(editor, {\n    ...editorNodesOptions,\n    match: {\n      type: activeType,\n    },\n  });\n\n  if (isActive && activeType === inactiveType) return;\n\n  setElements(\n    editor,\n    {\n      type: isActive ? inactiveType : activeType,\n    },\n    { at: at as any }\n  );\n};\n","export const ELEMENT_DEFAULT = 'p';\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type {\n  PluginOptions,\n  WithPlatePlugin,\n} from '../types/plugin/PlatePlugin';\nimport type { PluginKey } from '../types/plugin/PlatePluginKey';\n\n/** Get `editor.pluginsByKey` */\nexport const getPluginsByKey = <\n  P = PluginOptions,\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  editor?: E\n): Record<PluginKey, WithPlatePlugin<P, V, E>> => {\n  return (\n    (editor?.pluginsByKey as Record<PluginKey, WithPlatePlugin<P, V, E>>) ?? {}\n  );\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type {\n  PluginOptions,\n  WithPlatePlugin,\n} from '../types/plugin/PlatePlugin';\nimport type { PluginKey } from '../types/plugin/PlatePluginKey';\n\nimport { getPluginsByKey } from './getPluginsByKey';\n\n/** Get plugin options by plugin key. */\nexport const getPlugin = <\n  P = PluginOptions,\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  editor: E,\n  key: PluginKey\n): WithPlatePlugin<P, V, E> => getPluginsByKey<P, V, E>(editor)[key] ?? { key };\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\n\nimport { getPlugin } from './getPlugin';\n\n/** Get plugin type option by plugin key. */\nexport const getPluginType = <V extends Value>(\n  editor: PlateEditor<V>,\n  key: string\n): string => getPlugin<{}, V>(editor, key).type ?? key ?? '';\n","import type { Value } from '@udecode/slate';\n\nimport { isDefined } from '@udecode/utils';\n\nimport type { PlateProps } from '../client';\nimport type { PlateEditor, PlatePlugin } from '../shared/types';\n\nimport {\n  KEY_DESERIALIZE_AST,\n  KEY_DESERIALIZE_HTML,\n  KEY_EDITOR_PROTOCOL,\n  KEY_EVENT_EDITOR,\n  KEY_INLINE_VOID,\n  KEY_INSERT_DATA,\n  KEY_LENGTH,\n  KEY_NODE_FACTORY,\n  KEY_PREV_SELECTION,\n  createDeserializeAstPlugin,\n  createDeserializeHtmlPlugin,\n  createEditorProtocolPlugin,\n  createEventEditorPlugin,\n  createHistoryPlugin,\n  createInlineVoidPlugin,\n  createInsertDataPlugin,\n  createLengthPlugin,\n  createNodeFactoryPlugin,\n  createPrevSelectionPlugin,\n} from '../shared/plugins';\nimport { flattenDeepPlugins } from '../shared/utils/flattenDeepPlugins';\nimport { overridePluginsByKey } from '../shared/utils/overridePluginsByKey';\nimport { createReactPlugin } from './createReactPlugin';\n\nexport const setPlatePlugins = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  editor: E,\n  {\n    disableCorePlugins,\n    maxLength,\n    plugins: _plugins = [],\n  }: Pick<PlateProps<V, E>, 'disableCorePlugins' | 'maxLength' | 'plugins'>\n) => {\n  let plugins: PlatePlugin<{}, V, PlateEditor<V>>[] = [];\n\n  if (disableCorePlugins !== true) {\n    const dcp = disableCorePlugins;\n\n    if (typeof dcp !== 'object' || !dcp?.react) {\n      plugins.push((editor?.pluginsByKey?.react as any) ?? createReactPlugin());\n    }\n    if (typeof dcp !== 'object' || !dcp?.history) {\n      plugins.push(\n        (editor?.pluginsByKey?.history as any) ?? createHistoryPlugin()\n      );\n    }\n    if (typeof dcp !== 'object' || !dcp?.nodeFactory) {\n      plugins.push(\n        (editor?.pluginsByKey?.[KEY_NODE_FACTORY] as any) ??\n          createNodeFactoryPlugin()\n      );\n    }\n    if (typeof dcp !== 'object' || !dcp?.eventEditor) {\n      plugins.push(\n        (editor?.pluginsByKey?.[KEY_EVENT_EDITOR] as any) ??\n          createEventEditorPlugin()\n      );\n    }\n    if (typeof dcp !== 'object' || !dcp?.inlineVoid) {\n      plugins.push(\n        (editor?.pluginsByKey?.[KEY_INLINE_VOID] as any) ??\n          createInlineVoidPlugin()\n      );\n    }\n    if (typeof dcp !== 'object' || !dcp?.insertData) {\n      plugins.push(\n        (editor?.pluginsByKey?.[KEY_INSERT_DATA] as any) ??\n          createInsertDataPlugin()\n      );\n    }\n    if (typeof dcp !== 'object' || !dcp?.selection) {\n      plugins.push(\n        (editor?.pluginsByKey?.[KEY_PREV_SELECTION] as any) ??\n          createPrevSelectionPlugin()\n      );\n    }\n    if ((typeof dcp !== 'object' || !dcp?.length) && isDefined(maxLength)) {\n      plugins.push(\n        (editor?.pluginsByKey?.[KEY_LENGTH] as any) ??\n          createLengthPlugin({\n            options: {\n              maxLength,\n            },\n          })\n      );\n    }\n    if (typeof dcp !== 'object' || !dcp?.deserializeHtml) {\n      plugins.push(\n        (editor?.pluginsByKey?.[KEY_DESERIALIZE_HTML] as any) ??\n          createDeserializeHtmlPlugin()\n      );\n    }\n    if (typeof dcp !== 'object' || !dcp?.deserializeAst) {\n      plugins.push(\n        (editor?.pluginsByKey?.[KEY_DESERIALIZE_AST] as any) ??\n          createDeserializeAstPlugin()\n      );\n    }\n    if (typeof dcp !== 'object' || !dcp?.editorProtocol) {\n      plugins.push(\n        (editor?.pluginsByKey?.[KEY_EDITOR_PROTOCOL] as any) ??\n          createEditorProtocolPlugin()\n      );\n    }\n  }\n\n  plugins = [...plugins, ..._plugins] as any;\n\n  editor.plugins = [];\n  editor.pluginsByKey = {};\n\n  flattenDeepPlugins(editor, plugins);\n\n  // override all the plugins one by one, so plugin.overrideByKey effects can be overridden by the next plugin\n  editor.plugins.forEach((plugin) => {\n    if (plugin.overrideByKey) {\n      const newPlugins = editor.plugins.map((p) => {\n        return overridePluginsByKey<V>(p as any, plugin.overrideByKey as any);\n      });\n\n      editor.plugins = [];\n      editor.pluginsByKey = {};\n\n      // flatten again the overrides\n      flattenDeepPlugins<V>(editor, newPlugins as any);\n    }\n  });\n};\n","import castArray from 'lodash/castArray.js';\n\nimport { createPluginFactory } from '../utils/createPluginFactory';\n\nexport const KEY_DESERIALIZE_AST = 'deserializeAst';\n\n/**\n * Enables support for deserializing inserted content from Slate Ast format to\n * Slate format while apply a small bug fix.\n */\nexport const createDeserializeAstPlugin = createPluginFactory({\n  editor: {\n    insertData: {\n      format: 'application/x-slate-fragment',\n      getFragment: ({ data }) => {\n        const decoded = decodeURIComponent(window.atob(data));\n        let parsed;\n\n        try {\n          parsed = JSON.parse(decoded);\n        } catch (error) {\n          /* empty */\n        }\n\n        return castArray(parsed);\n      },\n    },\n  },\n  key: KEY_DESERIALIZE_AST,\n});\n","import type { Value } from '@udecode/slate';\n\nimport type { OverrideByKey } from '../types/OverrideByKey';\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { NoInfer } from '../types/misc/NoInfer';\nimport type { PlatePlugin, PluginOptions } from '../types/plugin/PlatePlugin';\n\nimport { overridePluginsByKey } from './overridePluginsByKey';\n\n/**\n * Create plugin factory with a default plugin.\n *\n * - First param is the default plugin.\n * - The only required property of the default plugin is `key`.\n * - Returns a plugin factory:\n *\n *   - First param `override` can be used to (deeply) override the default plugin.\n *   - Second param `overrideByKey` can be used to (deeply) override by key a nested\n *       plugin (in plugin.plugins).\n */\nexport const createPluginFactory =\n  <\n    P = PluginOptions,\n    V extends Value = Value,\n    E extends PlateEditor<V> = PlateEditor<V>,\n  >(\n    defaultPlugin: PlatePlugin<NoInfer<P>, V, E>\n  ) =>\n  <OP = P, OV extends Value = V, OE extends PlateEditor<OV> = PlateEditor<OV>>(\n    override?: Partial<PlatePlugin<NoInfer<OP>, OV, OE>>,\n    overrideByKey: OverrideByKey<OV, OE> = {}\n  ): PlatePlugin<NoInfer<OP>, OV, OE> => {\n    overrideByKey[defaultPlugin.key] = override as any;\n\n    return overridePluginsByKey<OP, OV, OE>(\n      { ...defaultPlugin } as any,\n      overrideByKey\n    );\n  };\n","import {\n  type EAncestor,\n  type GetAboveNodeOptions,\n  type TEditor,\n  type Value,\n  getAboveNode,\n  getMarks,\n  isExpanded,\n  isStartPoint,\n  removeEditorMark,\n} from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/index';\n\nimport { createPluginFactory } from '../utils/createPluginFactory';\n\nconst getBlockAbove = <N extends EAncestor<V>, V extends Value = Value>(\n  editor: TEditor<V>,\n  options: GetAboveNodeOptions<V> = {}\n) =>\n  getAboveNode<N, V>(editor, {\n    ...options,\n    block: true,\n  });\n\nconst isSelectionAtBlockStart = <V extends Value>(\n  editor: TEditor<V>,\n  options?: GetAboveNodeOptions<V>\n) => {\n  const { selection } = editor;\n\n  if (!selection) return false;\n\n  const path = getBlockAbove(editor, options)?.[1];\n\n  if (!path) return false;\n\n  return (\n    isStartPoint(editor, selection.focus, path) ||\n    (isExpanded(editor.selection) &&\n      isStartPoint(editor, selection.anchor, path))\n  );\n};\n\nconst removeSelectionMark = <V extends Value = Value>(editor: TEditor<V>) => {\n  const marks = getMarks(editor);\n\n  if (!marks) return;\n\n  // remove all marks\n  Object.keys(marks).forEach((key) => {\n    removeEditorMark(editor, key);\n  });\n};\n\nexport const KEY_EDITOR_PROTOCOL = 'editorProtocol';\n\nexport const withEditorProtocol = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  editor: E\n) => {\n  const { deleteBackward, deleteForward, deleteFragment } = editor;\n\n  const resetMarks = () => {\n    if (isSelectionAtBlockStart(editor)) {\n      removeSelectionMark(editor);\n    }\n  };\n\n  editor.deleteBackward = (unit) => {\n    deleteBackward(unit);\n\n    resetMarks();\n  };\n\n  editor.deleteForward = (unit) => {\n    deleteForward(unit);\n\n    resetMarks();\n  };\n\n  editor.deleteFragment = (direction) => {\n    deleteFragment(direction);\n\n    resetMarks();\n  };\n\n  return editor;\n};\n\nexport const createEditorProtocolPlugin = createPluginFactory({\n  key: KEY_EDITOR_PROTOCOL,\n  withOverrides: withEditorProtocol,\n});\n","import type { TEditor, THistoryEditor, Value } from '@udecode/slate';\n\nimport { withHistory } from 'slate-history';\n\nimport { createPluginFactory } from '../utils/createPluginFactory';\n\nexport const KEY_HISTORY = 'history';\n\nexport const withTHistory = <\n  V extends Value = Value,\n  E extends TEditor<V> = TEditor<V>,\n  EE extends E = E & THistoryEditor<V>,\n>(\n  editor: E\n) => withHistory(editor as any) as any as EE;\n\n/** @see {@link withHistory} */\nexport const createHistoryPlugin = createPluginFactory({\n  key: KEY_HISTORY,\n  withOverrides: withTHistory,\n});\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\n\nimport { createPluginFactory } from '../utils/createPluginFactory';\n\nexport const KEY_INLINE_VOID = 'inline-void';\n\n/**\n * Merge and register all the inline types and void types from the plugins and\n * options, using `editor.isInline`, `editor.markableVoid` and `editor.isVoid`\n */\nexport const withInlineVoid = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  editor: E\n) => {\n  const { isInline, isVoid, markableVoid } = editor;\n\n  const voidTypes: string[] = [];\n  const inlineTypes: string[] = [];\n  const markableVoidTypes: string[] = [];\n\n  editor.plugins.forEach((plugin) => {\n    if (plugin.isInline) {\n      inlineTypes.push(plugin.type);\n    }\n    if (plugin.isVoid) {\n      voidTypes.push(plugin.type);\n    }\n    if (plugin.isMarkableVoid) {\n      markableVoidTypes.push(plugin.type);\n    }\n  });\n\n  editor.isInline = (element) => {\n    return inlineTypes.includes(element.type) ? true : isInline(element);\n  };\n\n  editor.isVoid = (element) => {\n    return voidTypes.includes(element.type) ? true : isVoid(element);\n  };\n\n  editor.markableVoid = (element) => {\n    return markableVoidTypes.includes(element.type)\n      ? true\n      : markableVoid(element);\n  };\n\n  return editor;\n};\n\n/** @see {@link withInlineVoid} */\nexport const createInlineVoidPlugin = createPluginFactory({\n  key: KEY_INLINE_VOID,\n  withOverrides: withInlineVoid,\n});\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type {\n  PlatePlugin,\n  PluginOptions,\n  WithPlatePlugin,\n} from '../types/plugin/PlatePlugin';\n\nexport type InjectedPlugin<\n  P = PluginOptions,\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n> = Partial<PlatePlugin<P, V, E>>;\n\n/**\n * Get all plugins having a defined `inject.pluginsByKey[plugin.key]`. It\n * includes `plugin` itself.\n */\nexport const getInjectedPlugins = <\n  P = PluginOptions,\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  editor: PlateEditor<V>,\n  plugin: WithPlatePlugin<P, V, E>\n): InjectedPlugin<P, V, E>[] => {\n  const injectedPlugins: InjectedPlugin<P, V, E>[] = [];\n\n  [...editor.plugins].reverse().forEach((p) => {\n    const injectedPlugin = p.inject.pluginsByKey?.[\n      plugin.key\n    ] as InjectedPlugin<P, V, E>;\n\n    if (injectedPlugin) injectedPlugins.push(injectedPlugin);\n  });\n\n  return [plugin as InjectedPlugin<P, V, E>, ...injectedPlugins];\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { PluginOptions } from '../types/plugin/PlatePlugin';\nimport type { PlatePluginInsertDataOptions } from '../types/plugin/PlatePluginInsertData';\nimport type { InjectedPlugin } from './getInjectedPlugins';\n\n/** Is the plugin disabled by another plugin. */\nexport const pipeInsertDataQuery = <\n  P = PluginOptions,\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  plugins: InjectedPlugin<P, V, E>[],\n  { data, dataTransfer }: PlatePluginInsertDataOptions\n) =>\n  plugins.every((p) => {\n    const query = p.editor?.insertData?.query;\n\n    return (\n      !query ||\n      query({\n        data,\n        dataTransfer,\n      })\n    );\n  });\n","import {\n  type EElementOrText,\n  type Value,\n  withoutNormalizing,\n} from '@udecode/slate';\n\nimport type { PlateEditor } from '../types';\nimport type { PlatePluginInsertDataOptions } from '../types/plugin/PlatePluginInsertData';\nimport type { InjectedPlugin } from './getInjectedPlugins';\n\n/** Pipe preInsert then insertFragment. */\nexport const pipeInsertFragment = <V extends Value>(\n  editor: PlateEditor<V>,\n  injectedPlugins: InjectedPlugin<{}, V>[],\n  {\n    fragment,\n    ...options\n  }: { fragment: EElementOrText<V>[] } & PlatePluginInsertDataOptions\n) => {\n  withoutNormalizing(editor, () => {\n    injectedPlugins.some((p) => {\n      return p.editor?.insertData?.preInsert?.(fragment, options) === true;\n    });\n\n    editor.insertFragment(fragment);\n  });\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PluginOptions } from '../types/plugin/PlatePlugin';\nimport type { PlatePluginInsertDataOptions } from '../types/plugin/PlatePluginInsertData';\nimport type { InjectedPlugin } from './getInjectedPlugins';\n\n/** Pipe editor.insertData.transformData */\nexport const pipeTransformData = <V extends Value>(\n  plugins: InjectedPlugin<PluginOptions, V>[],\n  { data, dataTransfer }: PlatePluginInsertDataOptions\n) => {\n  plugins.forEach((p) => {\n    const transformData = p.editor?.insertData?.transformData;\n\n    if (!transformData) return;\n\n    data = transformData(data, { dataTransfer });\n  });\n\n  return data;\n};\n","import type { EElementOrText, Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { PlatePluginInsertDataOptions } from '../types/plugin/PlatePluginInsertData';\nimport type { InjectedPlugin } from './getInjectedPlugins';\n\n/** Pipe editor.insertData.transformFragment */\nexport const pipeTransformFragment = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  plugins: InjectedPlugin<{}, V, E>[],\n  {\n    fragment,\n    ...options\n  }: { fragment: EElementOrText<V>[] } & PlatePluginInsertDataOptions\n) => {\n  plugins.forEach((p) => {\n    const transformFragment = p.editor?.insertData?.transformFragment;\n\n    if (!transformFragment) return;\n\n    fragment = transformFragment(fragment, options);\n  });\n\n  return fragment;\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\n\nimport { createPluginFactory } from '../utils/createPluginFactory';\nimport { getInjectedPlugins } from '../utils/getInjectedPlugins';\nimport { pipeInsertDataQuery } from '../utils/pipeInsertDataQuery';\nimport { pipeInsertFragment } from '../utils/pipeInsertFragment';\nimport { pipeTransformData } from '../utils/pipeTransformData';\nimport { pipeTransformFragment } from '../utils/pipeTransformFragment';\n\nexport const withInsertData = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  editor: E\n) => {\n  const { insertData } = editor;\n\n  editor.insertData = (dataTransfer) => {\n    const inserted = [...editor.plugins].reverse().some((plugin) => {\n      const insertDataOptions = plugin.editor.insertData;\n\n      if (!insertDataOptions) return false;\n\n      const injectedPlugins = getInjectedPlugins<{}, V>(editor, plugin);\n      const { format, getFragment } = insertDataOptions;\n\n      if (!format) return false;\n\n      let data = dataTransfer.getData(format);\n\n      if (!data) return;\n      if (\n        !pipeInsertDataQuery<{}, V>(injectedPlugins, {\n          data,\n          dataTransfer,\n        })\n      ) {\n        return false;\n      }\n\n      data = pipeTransformData(injectedPlugins, {\n        data,\n        dataTransfer,\n      });\n\n      let fragment = getFragment?.({\n        data,\n        dataTransfer,\n      });\n\n      if (!fragment?.length) return false;\n\n      fragment = pipeTransformFragment(injectedPlugins, {\n        data,\n        dataTransfer,\n        fragment,\n      });\n\n      if (fragment.length === 0) return false;\n\n      pipeInsertFragment(editor, injectedPlugins, {\n        data,\n        dataTransfer,\n        fragment,\n      });\n\n      return true;\n    });\n\n    if (inserted) return;\n\n    insertData(dataTransfer);\n  };\n\n  return editor;\n};\n\nexport const KEY_INSERT_DATA = 'insertData';\n\nexport const createInsertDataPlugin = createPluginFactory({\n  key: KEY_INSERT_DATA,\n  withOverrides: withInsertData,\n});\n","import { getEditorString, withoutNormalizing } from '@udecode/slate';\n\nimport type { WithOverride } from '../types/index';\n\nimport { createPluginFactory } from '../utils/createPluginFactory';\n\nexport type LengthPlugin = {\n  maxLength: number;\n};\n\nexport const KEY_LENGTH = 'length';\n\nexport const withLength: WithOverride<LengthPlugin> = (editor, { options }) => {\n  const { apply } = editor;\n\n  editor.apply = (operation) => {\n    withoutNormalizing(editor, () => {\n      apply(operation);\n\n      if (options.maxLength) {\n        const length = getEditorString(editor, []).length;\n\n        // Make sure to remove overflow of text beyond character limit\n        if (length > options.maxLength) {\n          const overflowLength = length - options.maxLength;\n\n          editor.delete({\n            distance: overflowLength,\n            reverse: true,\n            unit: 'character',\n          });\n        }\n      }\n    });\n  };\n\n  return editor;\n};\n\nexport const createLengthPlugin = createPluginFactory<LengthPlugin>({\n  key: KEY_LENGTH,\n  withOverrides: withLength,\n});\n","import type { Path } from 'slate';\n\nimport {\n  type NodeOf,\n  type QueryNodeOptions,\n  type TNode,\n  type TNodeEntry,\n  isAncestor,\n  queryNode,\n} from '@udecode/slate';\n\nexport interface ApplyDeepToNodesOptions<N extends TNode> {\n  // Function to call on each node following the query.\n  apply: (\n    node: NodeOf<N>,\n    source: (() => Record<string, any>) | Record<string, any>\n  ) => void;\n  // The destination node object.\n  node: N;\n  // The source object. Can be a factory.\n  source: (() => Record<string, any>) | Record<string, any>;\n  path?: Path;\n  // Query to filter the nodes.\n  query?: QueryNodeOptions;\n}\n\n/** Recursively apply an operation to children nodes with a query. */\nexport const applyDeepToNodes = <N extends TNode>({\n  apply,\n  node,\n  path = [],\n  query,\n  source,\n}: ApplyDeepToNodesOptions<N>) => {\n  const entry: TNodeEntry<N> = [node, path];\n\n  if (queryNode<N>(entry, query)) {\n    if (source instanceof Function) {\n      apply(node, source());\n    } else {\n      apply(node, source);\n    }\n  }\n  if (!isAncestor(node)) return;\n\n  node.children.forEach((child, index) => {\n    applyDeepToNodes({\n      apply,\n      node: child as any,\n      path: path.concat([index]),\n      query,\n      source,\n    });\n  });\n};\n","import type { Value } from '@udecode/slate';\n\nimport defaultsDeep from 'lodash/defaultsDeep.js';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { PlatePlugin } from '../types/plugin/PlatePlugin';\n\nimport { mergeDeepPlugins } from './mergeDeepPlugins';\nimport { setDefaultPlugin } from './setDefaultPlugin';\n\n/** Recursively merge plugin.plugins into editor.plugins and editor.pluginsByKey */\nexport const flattenDeepPlugins = <V extends Value>(\n  editor: PlateEditor<V>,\n  plugins?: PlatePlugin<{}, V>[]\n) => {\n  if (!plugins) return;\n\n  plugins.forEach((plugin) => {\n    let p = setDefaultPlugin(plugin);\n\n    p = mergeDeepPlugins<V>(editor, p);\n\n    if (p.enabled === false) return;\n    if (editor.pluginsByKey[p.key]) {\n      const index = editor.plugins.indexOf(editor.pluginsByKey[p.key]);\n\n      const mergedPlugin = defaultsDeep(p, editor.pluginsByKey[p.key]);\n\n      if (index >= 0) {\n        editor.plugins[index] = mergedPlugin;\n      }\n\n      editor.pluginsByKey[p.key] = mergedPlugin;\n    } else {\n      editor.plugins.push(p);\n      editor.pluginsByKey[p.key] = p;\n    }\n\n    flattenDeepPlugins(editor, p.plugins!);\n  });\n};\n","import type { Value } from '@udecode/slate';\n\nimport defaultsDeep from 'lodash/defaultsDeep.js';\nimport keyBy from 'lodash/keyBy.js';\nimport merge from 'lodash/merge.js';\nimport values from 'lodash/values.js';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { WithPlatePlugin } from '../types/plugin/PlatePlugin';\n\n/** Recursively merge nested plugins into the root plugins */\nexport const mergeDeepPlugins = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n  P extends WithPlatePlugin<{}, V, E> = WithPlatePlugin<{}, V, E>,\n>(\n  editor: E,\n  _plugin: P\n): P => {\n  const plugin = { ..._plugin };\n\n  const { then } = plugin;\n\n  if (then) {\n    delete plugin.then;\n\n    const { plugins: pluginPlugins } = plugin;\n\n    const pluginThen = mergeDeepPlugins<V, E, P>(\n      editor,\n      defaultsDeep(then(editor, plugin), plugin)\n    );\n\n    // merge plugins by key\n    if (pluginPlugins && pluginThen.plugins) {\n      const merged = merge(\n        keyBy(pluginPlugins, 'key'),\n        keyBy(pluginThen.plugins, 'key')\n      );\n\n      pluginThen.plugins = values(merged);\n    }\n\n    return pluginThen;\n  }\n\n  return plugin;\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type {\n  PlatePlugin,\n  PluginOptions,\n  WithPlatePlugin,\n} from '../types/plugin/PlatePlugin';\n\nexport const setDefaultPlugin = <\n  P = PluginOptions,\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  plugin: PlatePlugin<P, V, E>\n): WithPlatePlugin<P, V, E> => {\n  if (plugin.type === undefined) plugin.type = plugin.key;\n  if (!plugin.options) plugin.options = {} as any;\n  if (!plugin.inject) plugin.inject = {};\n  if (!plugin.editor) plugin.editor = {};\n\n  return plugin as WithPlatePlugin<P, V, E>;\n};\n","import type { Value } from '@udecode/slate';\n\nimport castArray from 'lodash/castArray.js';\n\nimport type { PlateEditor } from '../types/PlateEditor';\n\n/** Get plugin keys by types */\nexport const getKeysByTypes = <V extends Value>(\n  editor: PlateEditor<V>,\n  type: string | string[]\n) => {\n  const types = castArray<string>(type);\n\n  const found = Object.values(editor.pluginsByKey).filter((plugin) => {\n    return types.includes(plugin.type);\n  });\n\n  return found.map((p) => p.key);\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\n\nimport { getKeysByTypes } from './getKeysByTypes';\n\n/** Get plugin key by type */\nexport const getKeyByType = <V extends Value>(\n  editor: PlateEditor<V>,\n  type: string\n): string | undefined => {\n  return getKeysByTypes<V>(editor, type)[0];\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { PluginKey } from '../types/plugin/PlatePluginKey';\n\nimport { getPlugin } from './getPlugin';\n\nexport const getPluginInjectProps = <V extends Value>(\n  editor: PlateEditor<V>,\n  key: PluginKey\n) => getPlugin<{}, V>(editor, key).inject?.props ?? {};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { PluginKey } from '../types/plugin/PlatePluginKey';\n\nimport { getPlugin } from './getPlugin';\n\nexport const getPluginOptions = <\n  P,\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  editor: E,\n  key: PluginKey\n): P => getPlugin<P, V, E>(editor, key).options ?? ({} as P);\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\n\nimport { getPluginType } from './getPluginType';\n\n/** Get plugin types option by plugin keys. */\nexport const getPluginTypes = <V extends Value>(\n  editor: PlateEditor<V>,\n  keys: string[]\n) => keys.map((key) => getPluginType(editor, key));\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { PlatePlugin, PluginOptions } from '../types/plugin/PlatePlugin';\n\n/** Get `editor.plugins` */\nexport const getPlugins = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  editor: E\n): PlatePlugin<PluginOptions, V, E>[] => {\n  return (editor?.plugins as PlatePlugin<PluginOptions, V, E>[]) ?? [];\n};\n","import type { Value } from '@udecode/slate';\nimport type { AnyObject } from '@udecode/utils';\n\nimport { clsx } from 'clsx';\nimport pick from 'lodash/pick.js';\n\nimport type { PlateRenderNodeProps } from '../types/PlateRenderNodeProps';\nimport type { WithPlatePlugin } from '../types/plugin/PlatePlugin';\n\nimport { getSlateClass } from './misc/getSlateClass';\n\n/**\n * Override node props with plugin props. Allowed properties in\n * `props.element.attributes` are passed as `nodeProps`. Extend the class name\n * with the node type.\n */\nexport const getRenderNodeProps = <V extends Value>({\n  attributes,\n  dangerouslyAllowAttributes,\n  nodeProps,\n  props,\n  type,\n}: {\n  attributes?: AnyObject;\n  dangerouslyAllowAttributes?: string[];\n  nodeProps: PlateRenderNodeProps<V>;\n} & Pick<WithPlatePlugin<V>, 'props' | 'type'>): PlateRenderNodeProps<V> => {\n  let newProps: AnyObject = {};\n\n  if (props) {\n    newProps =\n      (typeof props === 'function' ? props(nodeProps as any) : props) ?? {};\n  }\n  if (!newProps.nodeProps && attributes) {\n    /**\n     * WARNING: Improper use of `dangerouslyAllowAttributes` WILL make your\n     * application vulnerable to cross-site scripting (XSS) or information\n     * exposure attacks.\n     *\n     * @see {@link PlatePlugin.dangerouslyAllowAttributes}\n     */\n    newProps.nodeProps = pick(attributes, dangerouslyAllowAttributes ?? []);\n  }\n\n  nodeProps = { ...nodeProps, ...newProps };\n\n  if (nodeProps.nodeProps) {\n    // remove attributes values that are undefined\n    Object.keys(nodeProps.nodeProps).forEach((key) => {\n      if (nodeProps.nodeProps?.[key] === undefined) {\n        delete nodeProps.nodeProps?.[key];\n      }\n    });\n  }\n\n  const { className } = nodeProps;\n\n  return { ...nodeProps, className: clsx(getSlateClass(type), className) };\n};\n","/** Get slate class name: slate-<type> */\nexport const getSlateClass = (type: string) => `slate-${type}`;\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type {\n  PlatePlugin,\n  PluginOptions,\n  WithPlatePlugin,\n} from '../types/plugin/PlatePlugin';\nimport type { PluginKey } from '../types/plugin/PlatePluginKey';\n\nimport { getKeysByTypes } from './getKeysByTypes';\n\n/** Map plugin inject props to injected plugin */\nexport const mapInjectPropsToPlugin = <\n  P = PluginOptions,\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  editor: E,\n  plugin: WithPlatePlugin<P, V, E>,\n  injectedPlugin: Partial<PlatePlugin>\n) => {\n  const validTypes = plugin.inject.props?.validTypes;\n\n  if (!validTypes) return;\n\n  const keys = getKeysByTypes(editor, validTypes);\n\n  const injected: Record<PluginKey, Partial<PlatePlugin>> = {};\n\n  keys.forEach((key) => {\n    injected[key] = injectedPlugin;\n  });\n\n  return {\n    inject: {\n      pluginsByKey: injected,\n    },\n  };\n};\n","import type { TNode } from '@udecode/slate';\n\nimport merge from 'lodash/merge.js';\n\nimport {\n  type ApplyDeepToNodesOptions,\n  applyDeepToNodes,\n} from './applyDeepToNodes';\n\n/** Recursively merge a source object to children nodes with a query. */\nexport const mergeDeepToNodes = <N extends TNode>(\n  options: Omit<ApplyDeepToNodesOptions<N>, 'apply'>\n) => {\n  applyDeepToNodes({ ...options, apply: merge });\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { NoInfer } from '../types/misc/NoInfer';\nimport type {\n  PlatePlugin,\n  PluginOptions,\n  WithPlatePlugin,\n} from '../types/plugin/PlatePlugin';\n\nexport const mockPlugin = <\n  P = PluginOptions,\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  plugin?: Partial<PlatePlugin<NoInfer<P>>>\n): WithPlatePlugin<NoInfer<P>, V, E> =>\n  ({\n    editor: {} as any,\n    inject: {} as any,\n    key: '',\n    options: {} as any,\n    type: '',\n    ...plugin,\n  }) as any;\n","import {\n  type EDescendant,\n  type TDescendant,\n  type TEditor,\n  type Value,\n  isElement,\n  isText,\n} from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\n\nimport { ELEMENT_DEFAULT } from '../constants';\nimport { getPluginType } from './getPluginType';\n\nconst isInlineNode =\n  <V extends Value>(editor: Pick<TEditor<V>, 'isInline'>) =>\n  (node: EDescendant<V>) =>\n    isText(node) || (isElement(node) && editor.isInline(node));\n\nconst makeBlockLazy = (type: string) => (): TDescendant => ({\n  children: [],\n  type,\n});\n\nconst hasDifferentChildNodes = <N extends TDescendant>(\n  descendants: N[],\n  isInline: (node: N) => boolean\n): boolean => {\n  return descendants.some((descendant, index, arr) => {\n    const prevDescendant = arr[index - 1];\n\n    if (index !== 0) {\n      return isInline(descendant) !== isInline(prevDescendant);\n    }\n\n    return false;\n  });\n};\n\n/**\n * Handles 3rd constraint: \"Block nodes can only contain other blocks, or inline\n * and text nodes.\"\n */\nconst normalizeDifferentNodeTypes = <N extends TDescendant>(\n  descendants: N[],\n  isInline: (node: N) => boolean,\n  makeDefaultBlock: () => N\n): N[] => {\n  const hasDifferentNodes = hasDifferentChildNodes(descendants, isInline);\n\n  const { fragment } = descendants.reduce(\n    (memo, node) => {\n      if (hasDifferentNodes && isInline(node)) {\n        let block = memo.precedingBlock;\n\n        if (!block) {\n          block = makeDefaultBlock();\n          memo.precedingBlock = block;\n          memo.fragment.push(block);\n        }\n\n        (block.children as N[]).push(node);\n      } else {\n        memo.fragment.push(node);\n        memo.precedingBlock = null;\n      }\n\n      return memo;\n    },\n    {\n      fragment: [] as N[],\n      precedingBlock: null as N | null,\n    }\n  );\n\n  return fragment;\n};\n\n/**\n * Handles 1st constraint: \"All Element nodes must contain at least one Text\n * descendant.\"\n */\nconst normalizeEmptyChildren = <N extends TDescendant>(\n  descendants: N[]\n): N[] => {\n  if (descendants.length === 0) {\n    return [{ text: '' } as N];\n  }\n\n  return descendants;\n};\n\nconst normalize = <N extends TDescendant>(\n  descendants: N[],\n  isInline: (node: N) => boolean,\n  makeDefaultBlock: () => N\n): N[] => {\n  descendants = normalizeEmptyChildren(descendants);\n  descendants = normalizeDifferentNodeTypes(\n    descendants,\n    isInline,\n    makeDefaultBlock\n  );\n\n  descendants = descendants.map((node) => {\n    if (isElement(node)) {\n      return {\n        ...node,\n        children: normalize(node.children as N[], isInline, makeDefaultBlock),\n      };\n    }\n\n    return node;\n  });\n\n  return descendants;\n};\n\n/** Normalize the descendants to a valid document fragment. */\nexport const normalizeDescendantsToDocumentFragment = <V extends Value>(\n  editor: PlateEditor<V>,\n  { descendants }: { descendants: EDescendant<V>[] }\n): EDescendant<V>[] => {\n  const isInline = isInlineNode<V>(editor);\n  const defaultType = getPluginType(editor, ELEMENT_DEFAULT);\n  const makeDefaultBlock = makeBlockLazy(defaultType);\n\n  return normalize(descendants, isInline, makeDefaultBlock as any);\n};\n","import type { Value } from '@udecode/slate';\n\nimport cloneDeep from 'lodash/cloneDeep.js';\nimport isEqual from 'lodash/isEqual.js';\n\nimport type { PlateEditor } from '../types';\n\n/** Normalize initial value from editor plugins. Set into plate store if diff. */\nexport const normalizeInitialValue = <V extends Value>(\n  editor: PlateEditor<V>,\n  value: V\n) => {\n  let normalizedValue = cloneDeep(value);\n\n  editor.plugins.forEach((p) => {\n    const _normalizedValue = p.normalizeInitialValue?.(normalizedValue);\n\n    if (_normalizedValue) {\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      normalizedValue = _normalizedValue;\n    }\n  });\n\n  if (!isEqual(value, normalizedValue)) {\n    return normalizedValue;\n  }\n};\n","import type { Range } from 'slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { TEditableProps } from '../types/slate-react/TEditableProps';\n\n/**\n * @see {@link Decorate} .\n * Optimization: return undefined if empty list so Editable uses a memo.\n */\nexport const pipeDecorate = (\n  editor: PlateEditor,\n  decorateProp?: TEditableProps['decorate']\n): TEditableProps['decorate'] => {\n  const decorates = editor.plugins.flatMap(\n    (plugin) => plugin.decorate?.(editor, plugin) ?? []\n  );\n\n  if (decorateProp) {\n    decorates.push(decorateProp);\n  }\n  if (decorates.length === 0) return;\n\n  return (entry) => {\n    let ranges: Range[] = [];\n\n    const addRanges = (newRanges?: Range[]) => {\n      if (newRanges?.length) ranges = [...ranges, ...newRanges];\n    };\n\n    decorates.forEach((decorate) => {\n      addRanges(decorate(entry));\n    });\n\n    return ranges;\n  };\n};\n","import type React from 'react';\n\nimport type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type {\n  DOMHandlers,\n  HandlerReturnType,\n} from '../types/plugin/DOMHandlers';\nimport type { TEditableProps } from '../types/slate-react/TEditableProps';\n\nexport const convertDomEventToSyntheticEvent = (\n  domEvent: Event\n): React.SyntheticEvent<unknown, unknown> => {\n  let propagationStopped = false;\n\n  return {\n    ...domEvent,\n    bubbles: domEvent.bubbles,\n    cancelable: domEvent.cancelable,\n    currentTarget: domEvent.currentTarget!,\n    defaultPrevented: domEvent.defaultPrevented,\n    eventPhase: domEvent.eventPhase,\n    isDefaultPrevented: () => domEvent.defaultPrevented,\n    isPropagationStopped: () => propagationStopped,\n    isTrusted: domEvent.isTrusted,\n    nativeEvent: domEvent,\n    persist: () => {\n      throw new Error(\n        'persist is not implemented for synthetic events created using convertDomEventToSyntheticEvent'\n      );\n    },\n    preventDefault: () => domEvent.preventDefault(),\n    stopPropagation: () => {\n      propagationStopped = true;\n      domEvent.stopPropagation();\n    },\n    target: domEvent.target!,\n    timeStamp: domEvent.timeStamp,\n    type: domEvent.type,\n  };\n};\n\n/** Check if an event is overrided by a handler. */\nexport const isEventHandled = <\n  EventType extends React.SyntheticEvent<unknown, unknown>,\n>(\n  event: EventType,\n  handler?: (event: EventType) => boolean | void\n) => {\n  if (!handler) {\n    return false;\n  }\n\n  // The custom event handler may return a boolean to specify whether the event\n  // shall be treated as being handled or not.\n  const shouldTreatEventAsHandled = handler(event);\n\n  if (shouldTreatEventAsHandled != null) {\n    return shouldTreatEventAsHandled;\n  }\n\n  return event.isPropagationStopped();\n};\n\n/**\n * Generic pipe for handlers.\n *\n * - Get all the plugins handlers by `handlerKey`.\n * - If there is no plugin handler or editable prop handler for this key, return\n *   `undefined`.\n * - Return a handler calling all the plugins handlers then the prop handler.\n * - Any handler returning true will stop the next handlers to be called,\n *   including slate internal handler.\n */\nexport const pipeHandler = <V extends Value, K extends keyof DOMHandlers<V>>(\n  editor: PlateEditor<V>,\n  {\n    editableProps,\n    handlerKey,\n  }: { editableProps?: TEditableProps | null; handlerKey: K }\n): ((event: any) => void) | undefined => {\n  let pluginsHandlers: ((event: any) => HandlerReturnType)[] = [];\n  pluginsHandlers = editor.plugins.flatMap(\n    (plugin) => plugin.handlers?.[handlerKey]?.(editor, plugin) ?? []\n  );\n\n  const propsHandler = editableProps?.[handlerKey] as (\n    event: any\n  ) => HandlerReturnType | undefined;\n\n  if (pluginsHandlers.length === 0 && !propsHandler) return;\n\n  return (event: any) => {\n    const isDomEvent = event instanceof Event;\n    const handledEvent = isDomEvent\n      ? convertDomEventToSyntheticEvent(event)\n      : event;\n\n    const eventIsHandled = pluginsHandlers.some((handler) =>\n      isEventHandled(handledEvent, handler)\n    );\n\n    if (eventIsHandled) return true;\n\n    return isEventHandled(handledEvent, propsHandler);\n  };\n};\n","import type React from 'react';\n\nimport {\n  type EElement,\n  type EText,\n  type Value,\n  isElement,\n} from '@udecode/slate';\nimport { type AnyObject, isDefined } from '@udecode/utils';\nimport { clsx } from 'clsx';\n\nimport type { TransformOptions } from '../types';\nimport type { PlateEditor } from '../types/PlateEditor';\nimport type { WithPlatePlugin } from '../types/plugin/PlatePlugin';\n\nexport interface GetInjectPropsOptions<V extends Value = Value> {\n  /** Existing className. */\n  className?: string;\n\n  /** Style value or className key. */\n  element?: EElement<V>;\n\n  /** Existing style. */\n  style?: React.CSSProperties;\n\n  /** Style value or className key. */\n  text?: EText<V>;\n}\n\nexport interface GetInjectPropsReturnType extends AnyObject {\n  className?: string;\n  style?: React.CSSProperties;\n}\n\n/**\n * Return if `element`, `text`, `nodeKey` is defined. Return if `node.type` is\n * not in `validTypes` (if defined). Return if `value = node[nodeKey]` is not in\n * `validNodeValues` (if defined). If `classNames[value]` is defined, override\n * `className` with it. If `styleKey` is defined, override `style` with\n * `[styleKey]: value`.\n */\nexport const pluginInjectProps = <V extends Value>(\n  editor: PlateEditor<V>,\n  { inject: { props }, key }: WithPlatePlugin<{}, V>,\n  nodeProps: GetInjectPropsOptions<V>\n): GetInjectPropsReturnType | undefined => {\n  const { className, element, style, text } = nodeProps;\n\n  const node = element ?? text;\n\n  if (!node) return;\n  if (!props) return;\n\n  const {\n    classNames,\n    defaultNodeValue,\n    nodeKey = key,\n    query,\n    styleKey = nodeKey as any,\n    transformClassName,\n    transformNodeValue,\n    transformProps,\n    transformStyle,\n    validNodeValues,\n    validTypes,\n  } = props;\n\n  const queryResult = query?.(props, nodeProps);\n\n  if (\n    !queryResult &&\n    validTypes &&\n    isElement(node) &&\n    node.type &&\n    !validTypes.includes(node.type)\n  ) {\n    return;\n  }\n\n  const nodeValue = node[nodeKey!] as any;\n\n  // early return if there is no reason to inject props\n  if (\n    !queryResult &&\n    (!isDefined(nodeValue) ||\n      (validNodeValues && !validNodeValues.includes(nodeValue)) ||\n      nodeValue === defaultNodeValue)\n  ) {\n    return;\n  }\n\n  const transformOptions: TransformOptions<V> = { ...nodeProps, nodeValue };\n  const value = transformNodeValue?.(transformOptions) ?? nodeValue;\n  transformOptions.value = value;\n\n  let res: GetInjectPropsReturnType = {};\n\n  if (element) {\n    res.className = clsx(className, `slate-${nodeKey}-${nodeValue}`);\n  }\n  if (classNames?.[nodeValue] || transformClassName) {\n    res.className =\n      transformClassName?.(transformOptions) ??\n      clsx(className, classNames?.[value]);\n  }\n  if (styleKey) {\n    res.style = transformStyle?.(transformOptions) ?? {\n      ...style,\n      [styleKey as string]: value,\n    };\n  }\n  if (transformProps) {\n    res = transformProps(transformOptions, res) ?? res;\n  }\n\n  return res;\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\n\nimport { pluginInjectProps } from './pluginInjectProps';\n\n/** Inject plugin props, editor. */\nexport const pipeInjectProps = <V extends Value>(\n  editor: PlateEditor<V>,\n  nodeProps: any\n) => {\n  editor.plugins.forEach((plugin) => {\n    if (plugin.inject.props) {\n      const props = pluginInjectProps(editor, plugin, nodeProps);\n\n      if (props) {\n        nodeProps = {\n          ...nodeProps,\n          ...props,\n        };\n      }\n    }\n  });\n\n  return { ...nodeProps, editor };\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../types/PlateEditor';\n\nexport const pipeOnChange = <V extends Value>(editor: PlateEditor<V>) => {\n  const onChanges = editor.plugins.flatMap(\n    (plugin) => plugin.handlers?.onChange?.(editor, plugin) ?? []\n  );\n\n  return (nodes: V) => {\n    return onChanges.some((handler) => {\n      if (!handler) {\n        return false;\n      }\n\n      // The custom event handler may return a boolean to specify whether the event\n      // shall be treated as being handled or not.\n      const shouldTreatEventAsHandled = handler(nodes);\n\n      if (shouldTreatEventAsHandled != null) {\n        return shouldTreatEventAsHandled;\n      }\n\n      return false;\n    });\n  };\n};\n","import type React from 'react';\n\nimport { IS_APPLE } from '@udecode/utils';\nimport { isKeyHotkey } from 'is-hotkey';\n\nexport { isHotkey } from 'is-hotkey';\n\n/** Hotkey mappings for each platform. */\nconst HOTKEYS = {\n  bold: 'mod+b',\n  compose: ['down', 'left', 'right', 'up', 'backspace', 'enter'],\n  deleteBackward: 'shift?+backspace',\n  deleteForward: 'shift?+delete',\n  extendBackward: 'shift+left',\n  extendForward: 'shift+right',\n  insertSoftBreak: 'shift+enter',\n  italic: 'mod+i',\n  moveBackward: 'left',\n  moveForward: 'right',\n  moveWordBackward: 'ctrl+left',\n  moveWordForward: 'ctrl+right',\n  splitBlock: 'enter',\n  tab: 'tab',\n  undo: 'mod+z',\n  untab: 'shift+tab',\n};\n\nconst APPLE_HOTKEYS = {\n  deleteBackward: ['ctrl+backspace', 'ctrl+h'],\n  deleteForward: ['ctrl+delete', 'ctrl+d'],\n  deleteLineBackward: 'cmd+shift?+backspace',\n  deleteLineForward: ['cmd+shift?+delete', 'ctrl+k'],\n  deleteWordBackward: 'opt+shift?+backspace',\n  deleteWordForward: 'opt+shift?+delete',\n  extendLineBackward: 'opt+shift+up',\n  extendLineForward: 'opt+shift+down',\n  moveLineBackward: 'opt+up',\n  moveLineForward: 'opt+down',\n  moveWordBackward: 'opt+left',\n  moveWordForward: 'opt+right',\n  redo: 'cmd+shift+z',\n  transposeCharacter: 'ctrl+t',\n};\n\nconst WINDOWS_HOTKEYS = {\n  deleteWordBackward: 'ctrl+shift?+backspace',\n  deleteWordForward: 'ctrl+shift?+delete',\n  redo: ['ctrl+y', 'ctrl+shift+z'],\n};\n\n/** Create a platform-aware hotkey checker. */\n\nexport const createHotkey = (key: string) => {\n  const generic = (HOTKEYS as any)[key];\n  const apple = (APPLE_HOTKEYS as any)[key];\n  const windows = (WINDOWS_HOTKEYS as any)[key];\n  const isGeneric = generic && isKeyHotkey(generic);\n  const isApple = apple && isKeyHotkey(apple);\n  const isWindows = windows && isKeyHotkey(windows);\n\n  return (event: React.KeyboardEvent) => {\n    if (isGeneric?.(event)) return true;\n    if (IS_APPLE && isApple?.(event)) return true;\n    if (!IS_APPLE && isWindows?.(event)) return true;\n\n    return false;\n  };\n};\n\nexport const sharedHotkeys = {\n  isBold: createHotkey('bold'),\n  isCompose: createHotkey('compose'),\n  isDeleteBackward: createHotkey('deleteBackward'),\n  isDeleteForward: createHotkey('deleteForward'),\n  isDeleteLineBackward: createHotkey('deleteLineBackward'),\n  isDeleteLineForward: createHotkey('deleteLineForward'),\n  isDeleteWordBackward: createHotkey('deleteWordBackward'),\n  isDeleteWordForward: createHotkey('deleteWordForward'),\n  isExtendBackward: createHotkey('extendBackward'),\n  isExtendForward: createHotkey('extendForward'),\n  isExtendLineBackward: createHotkey('extendLineBackward'),\n  isExtendLineForward: createHotkey('extendLineForward'),\n  isItalic: createHotkey('italic'),\n  isMoveBackward: createHotkey('moveBackward'),\n  isMoveForward: createHotkey('moveForward'),\n  isMoveLineBackward: createHotkey('moveLineBackward'),\n  isMoveLineForward: createHotkey('moveLineForward'),\n  isMoveWordBackward: createHotkey('moveWordBackward'),\n  isMoveWordForward: createHotkey('moveWordForward'),\n  isRedo: createHotkey('redo'),\n  isSoftBreak: createHotkey('insertSoftBreak'),\n  isSplitBlock: createHotkey('splitBlock'),\n  isTransposeCharacter: createHotkey('transposeCharacter'),\n  isUndo: createHotkey('undo'),\n};\n","import React from 'react';\n\ntype RefComponent<P, R> = {\n  ref?: React.Ref<R>;\n} & React.FC<P>;\n\n/* eslint-disable react/display-name */\nexport const withHOC = <ComponentProps, HOCProps, ComponentRef, HOCRef>(\n  HOC: RefComponent<HOCProps, HOCRef>,\n  Component: RefComponent<ComponentProps, ComponentRef>,\n  hocProps?: Omit<HOCProps, 'children'>,\n  hocRef?: React.Ref<HOCRef>\n) =>\n  React.forwardRef<ComponentRef, ComponentProps>((props, componentRef) => (\n    <HOC {...(hocProps as any)} ref={hocRef}>\n      <Component {...props} ref={componentRef} />\n    </HOC>\n  ));\n","import { ELEMENT_DEFAULT } from '../constants';\nimport { createPluginFactory } from '../utils/createPluginFactory';\nimport { getPluginType } from '../utils/index';\n\nexport const KEY_NODE_FACTORY = 'nodeFactory';\n\nexport const createNodeFactoryPlugin = createPluginFactory({\n  key: KEY_NODE_FACTORY,\n  withOverrides: (editor) => {\n    editor.blockFactory = (node) => ({\n      children: [{ text: '' }],\n      type: getPluginType(editor, ELEMENT_DEFAULT),\n      ...node,\n    });\n    editor.childrenFactory = () => [editor.blockFactory()];\n\n    return editor;\n  },\n});\n","import type { TRange } from '@udecode/slate';\n\nimport { createPluginFactory } from '../utils/createPluginFactory';\n\nexport const KEY_PREV_SELECTION = 'prevSelection';\n\nexport const createPrevSelectionPlugin = createPluginFactory({\n  handlers: {\n    onKeyDown: (editor) => (e) => {\n      // React 16.x needs this event to be persistented due to it's event pooling implementation.\n      // https://reactjs.org/docs/legacy-event-pooling.html\n      e.persist();\n      editor.currentKeyboardEvent = e;\n    },\n  },\n  key: KEY_PREV_SELECTION,\n  withOverrides: (editor) => {\n    const { apply } = editor;\n\n    editor.apply = (operation) => {\n      if (operation.type === 'set_selection') {\n        const { properties } = operation;\n\n        editor.prevSelection = properties as TRange | null;\n\n        apply(operation);\n\n        editor.currentKeyboardEvent = null;\n\n        return;\n      }\n\n      apply(operation);\n    };\n\n    return editor;\n  },\n});\n","export const FOCUS_EDITOR_EVENT = 'focus-editor-event';\n\nexport const BLUR_EDITOR_EVENT = 'blur-editor-event';\n","export { nanoid } from 'nanoid';\n","export type {\n  StateActions as ZustandStateActions,\n  StoreApi as ZustandStoreApi,\n} from 'zustand-x';\n\nexport { createZustandStore } from 'zustand-x';\n","import type { PlateId } from '../../../client/stores/plate';\n\nimport { createZustandStore } from '../../libs';\n\nexport type EventEditorState = {\n  /** Last editor id that has been blurred. */\n  blur: PlateId | null;\n  /** Editor id that is currently being focused. */\n  focus: PlateId | null;\n  /** Last editor id. */\n  last: PlateId | null;\n};\n\n/** Store where the keys are event names and the values are editor ids. */\nexport const eventEditorStore = createZustandStore('event-editor')({\n  blur: null,\n  focus: null,\n  last: null,\n} as EventEditorState);\n\nexport const eventEditorActions = eventEditorStore.set;\n\nexport const eventEditorSelectors = eventEditorStore.get;\n\nexport const useEventEditorSelectors = eventEditorStore.use;\n","import { createPluginFactory } from '../../utils/createPluginFactory';\nimport { BLUR_EDITOR_EVENT, FOCUS_EDITOR_EVENT } from './constants';\nimport { eventEditorActions, eventEditorSelectors } from './eventEditorStore';\n\nexport const KEY_EVENT_EDITOR = 'event-editor';\n\nexport const createEventEditorPlugin = createPluginFactory({\n  handlers: {\n    onBlur: (editor) => () => {\n      const focus = eventEditorSelectors.focus();\n\n      if (focus === editor.id) {\n        eventEditorActions.focus(null);\n      }\n\n      eventEditorActions.blur(editor.id);\n\n      document.dispatchEvent(\n        new CustomEvent(BLUR_EDITOR_EVENT, {\n          detail: { id: editor.id },\n        })\n      );\n    },\n    onFocus: (editor) => () => {\n      eventEditorActions.focus(editor.id);\n\n      document.dispatchEvent(\n        new CustomEvent(FOCUS_EDITOR_EVENT, {\n          detail: { id: editor.id },\n        })\n      );\n    },\n  },\n  key: KEY_EVENT_EDITOR,\n});\n","import type { PlateId } from '../../../client/stores/plate';\n\nimport { eventEditorSelectors } from './eventEditorStore';\n\nexport const getEventPlateId = (id?: PlateId) => {\n  if (id) return id;\n\n  const focus = eventEditorSelectors.focus();\n\n  if (focus) return focus;\n\n  const blur = eventEditorSelectors.blur();\n\n  if (blur) return blur;\n\n  return eventEditorSelectors.last() ?? 'plate';\n};\n","export const CARRIAGE_RETURN = '\\u000D';\n\nexport const LINE_FEED = '\\u000A';\n\nexport const NO_BREAK_SPACE = '\\u00A0';\n\nexport const SPACE = '\\u0020';\n\nexport const TAB = '\\u0009';\n\nexport const ZERO_WIDTH_SPACE = '\\u200B';\n","import type { TrimEndRule, TrimStartRule } from './types';\n\nexport const collapseString = (\n  text: string,\n  {\n    shouldCollapseWhiteSpace = true,\n    trimEnd = 'collapse',\n    trimStart = 'collapse',\n    whiteSpaceIncludesNewlines = true,\n  }: {\n    shouldCollapseWhiteSpace?: boolean;\n    trimEnd?: TrimEndRule;\n    trimStart?: TrimStartRule;\n    whiteSpaceIncludesNewlines?: boolean;\n  } = {}\n) => {\n  if (trimStart === 'all') {\n    text = text.replace(/^\\s+/, '');\n  }\n  if (trimEnd === 'single-newline') {\n    // Strip at most one newline from the end\n    text = text.replace(/\\n$/, '');\n  }\n  if (shouldCollapseWhiteSpace) {\n    if (whiteSpaceIncludesNewlines) {\n      text = text.replaceAll(/\\s+/g, ' ');\n    } else {\n      // Collapse horizontal whitespace\n      text = text.replaceAll(/[^\\S\\n\\r]+/g, ' ');\n\n      /**\n       * Trim horizontal whitespace from the start and end of lines (behavior of\n       * pre-line).\n       */\n      text = text.replaceAll(/^[^\\S\\n\\r]+/gm, '');\n      text = text.replaceAll(/[^\\S\\n\\r]+$/gm, '');\n    }\n  }\n\n  return text;\n};\n","/**\n * # Methodology\n *\n * ## Step 1. Get the list of all standard tag names\n *\n * Go to https://developer.mozilla.org/en-US/docs/Web/HTML/Element and run the\n * following in the console to generate a JSON array of tag names:\n *\n * ```js\n * JSON.stringify(\n *   Array.from(document.querySelectorAll('article table td:first-child'))\n *     .map((td) => {\n *       const body = document.createElement('body');\n *       body.innerHTML = td.textContent;\n *       return body.firstChild?.tagName;\n *     })\n *     .filter((tagName) => tagName)\n * );\n * ```\n *\n * Output (as of 2023-11-06):\n *\n * ```json\n * '[\"BASE\",\"LINK\",\"META\",\"STYLE\",\"TITLE\",\"ADDRESS\",\"ARTICLE\",\"ASIDE\",\"FOOTER\",\"HEADER\",\"H1\",\"HGROUP\",\"MAIN\",\"NAV\",\"SECTION\",\"SEARCH\",\"BLOCKQUOTE\",\"DD\",\"DIV\",\"DL\",\"DT\",\"FIGCAPTION\",\"FIGURE\",\"HR\",\"LI\",\"MENU\",\"OL\",\"P\",\"PRE\",\"UL\",\"A\",\"ABBR\",\"B\",\"BDI\",\"BDO\",\"BR\",\"CITE\",\"CODE\",\"DATA\",\"DFN\",\"EM\",\"I\",\"KBD\",\"MARK\",\"Q\",\"RP\",\"RT\",\"RUBY\",\"S\",\"SAMP\",\"SMALL\",\"SPAN\",\"STRONG\",\"SUB\",\"SUP\",\"TIME\",\"U\",\"VAR\",\"WBR\",\"AREA\",\"AUDIO\",\"IMG\",\"MAP\",\"TRACK\",\"VIDEO\",\"EMBED\",\"IFRAME\",\"OBJECT\",\"PICTURE\",\"PORTAL\",\"SOURCE\",\"svg\",\"math\",\"CANVAS\",\"NOSCRIPT\",\"SCRIPT\",\"DEL\",\"INS\",\"TABLE\",\"BUTTON\",\"DATALIST\",\"FIELDSET\",\"FORM\",\"INPUT\",\"LABEL\",\"LEGEND\",\"METER\",\"OPTGROUP\",\"OPTION\",\"OUTPUT\",\"PROGRESS\",\"SELECT\",\"TEXTAREA\",\"DETAILS\",\"DIALOG\",\"SUMMARY\",\"SLOT\",\"TEMPLATE\",\"ACRONYM\",\"BIG\",\"CENTER\",\"CONTENT\",\"DIR\",\"FONT\",\"IMG\",\"MARQUEE\",\"MENUITEM\",\"NOBR\",\"NOEMBED\",\"NOFRAMES\",\"PARAM\",\"PLAINTEXT\",\"RB\",\"RTC\",\"SHADOW\",\"STRIKE\",\"TT\",\"XMP\"]'\n * ```\n *\n * ## Step 2. For each tag name, determine the default browser style\n *\n * Open an empty HTML file in the browser and run the following in the console:\n *\n * ```js\n * const tagNames = JSON.parse(<JSON string from step 1>);\n *\n * JSON.stringify(\n *   tagNames.filter((tagName) => {\n *     const element = document.createElement(tagName);\n *     document.body.appendChild(element);\n *     const display = window.getComputedStyle(element).display;\n *     element.remove();\n *     return display.startsWith('inline');\n *   })\n * );\n * ```\n *\n * Place the result in the array below (accurate as of 2023-11-06).\n */\n\nexport const inlineTagNames = new Set([\n  'A',\n  'ABBR',\n  'B',\n  'BDI',\n  'BDO',\n  'BR',\n  'CITE',\n  'CODE',\n  'DATA',\n  'DFN',\n  'EM',\n  'I',\n  'KBD',\n  'MARK',\n  'Q',\n  'S',\n  'SAMP',\n  'SMALL',\n  'SPAN',\n  'STRONG',\n  'SUB',\n  'SUP',\n  'TIME',\n  'U',\n  'VAR',\n  'WBR',\n  'IMG',\n  'MAP',\n  'TRACK',\n  'VIDEO',\n  'EMBED',\n  'IFRAME',\n  'OBJECT',\n  'PICTURE',\n  'PORTAL',\n  'SOURCE',\n  'svg',\n  'math',\n  'CANVAS',\n  'DEL',\n  'INS',\n  'BUTTON',\n  'INPUT',\n  'LABEL',\n  'METER',\n  'OUTPUT',\n  'PROGRESS',\n  'SELECT',\n  'TEXTAREA',\n  'ACRONYM',\n  'BIG',\n  'CONTENT',\n  'FONT',\n  'IMG',\n  'MARQUEE',\n  'MENUITEM',\n  'NOBR',\n  'SHADOW',\n  'STRIKE',\n  'TT',\n]);\n","export const isHtmlElement = (node: Node): node is Element =>\n  node.nodeType === Node.ELEMENT_NODE;\n","import { inlineTagNames } from './inlineTagNames';\nimport { isHtmlElement } from './isHtmlElement';\n\nexport const isHtmlInlineElement = (node: Node): boolean => {\n  if (!isHtmlElement(node)) return false;\n\n  const element = node as HTMLElement;\n\n  const tagNameIsInline = inlineTagNames.has(element.tagName);\n\n  /**\n   * Valid display values include 'inline flow'. We only care about the first\n   * part.\n   */\n  const displayProperty = element.style.display.split(' ')[0];\n\n  if (displayProperty === '') {\n    return tagNameIsInline;\n  }\n  if (displayProperty.startsWith('inline')) {\n    return true;\n  }\n  if (displayProperty === 'inherit' && element.parentElement) {\n    return isHtmlInlineElement(element.parentElement);\n  }\n  /**\n   * Handle all special values manually, so that any unhandled values can be\n   * assumed to be block.\n   *\n   * Note: Ideally, content inside `display: none` elements should not be\n   * parsed. However, if such elements are parsed, it's best for their inline or\n   * block status to be left unchanged.\n   */\n  if (\n    ['contents', 'initial', 'none', 'revert', 'revert-layer', 'unset'].includes(\n      displayProperty\n    )\n  ) {\n    return tagNameIsInline;\n  }\n\n  return false;\n};\n","export const isHtmlText = (node: Node): node is Text =>\n  node.nodeType === Node.TEXT_NODE;\n","import { isHtmlElement } from './isHtmlElement';\nimport { isHtmlInlineElement } from './isHtmlInlineElement';\n\nexport const isHtmlBlockElement = (node: Node): boolean => {\n  if (!isHtmlElement(node)) return false;\n\n  const element = node as HTMLElement;\n\n  return !isHtmlInlineElement(element);\n};\n","import { isHtmlBlockElement } from '../isHtmlBlockElement';\n\nexport const isLastNonEmptyTextOfInlineFormattingContext = (\n  initialText: Text\n): boolean => {\n  let currentNode: Node | null = initialText;\n\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    if (currentNode.nextSibling) {\n      currentNode = currentNode.nextSibling;\n    } else {\n      // If there is no next sibling, ascend to the parent node\n      currentNode = currentNode.parentElement;\n\n      // If the parent node is a block, we've reached the end\n      if (currentNode && isHtmlBlockElement(currentNode)) {\n        return true;\n      }\n\n      // Otherwise, continue to the next sibling of the parent node\n      currentNode = currentNode?.nextSibling || null;\n    }\n    // If there's no next node, we've reached the end\n    if (!currentNode) {\n      return true;\n    }\n    // If the next node is a block, we've reached the end\n    if (isHtmlBlockElement(currentNode)) {\n      return true;\n    }\n    // If the next node is a non-empty text node, we're not at the end\n    if ((currentNode.textContent || '').length > 0) {\n      return false;\n    }\n\n    // Otherwise, continue to the next node\n  }\n};\n","import type { CollapseWhiteSpaceState } from './types';\n\nexport const upsertInlineFormattingContext = (\n  state: CollapseWhiteSpaceState\n) => {\n  if (state.inlineFormattingContext) {\n    state.inlineFormattingContext.atStart = false;\n  } else {\n    state.inlineFormattingContext = {\n      atStart: true,\n      lastHasTrailingWhiteSpace: false,\n    };\n  }\n};\n\nexport const endInlineFormattingContext = (state: CollapseWhiteSpaceState) => {\n  state.inlineFormattingContext = null;\n};\n","import type {\n  CollapseWhiteSpaceState,\n  TrimEndRule,\n  TrimStartRule,\n} from './types';\n\nimport { collapseString } from './collapseString';\nimport { isLastNonEmptyTextOfInlineFormattingContext } from './isLastNonEmptyTextOfInlineFormattingContext';\nimport { upsertInlineFormattingContext } from './stateTransforms';\n\nexport const collapseWhiteSpaceText = (\n  text: Text,\n  state: CollapseWhiteSpaceState\n) => {\n  const textContent = text.textContent || '';\n  const isWhiteSpaceOnly = textContent.trim() === '';\n\n  /**\n   * Do not start an inline formatting context with a text node containing only\n   * white space.\n   */\n  if (state.inlineFormattingContext || !isWhiteSpaceOnly) {\n    upsertInlineFormattingContext(state);\n  }\n\n  const { whiteSpaceRule } = state;\n\n  /**\n   * Note: Due to the way HTML strings are parsed in htmlStringToDOMNode, up to\n   * one newline is already trimmed from the start of text nodes inside <pre>\n   * elements. If we do so again here, we may remove too many newlines. This\n   * only applies to actual <pre> elements, not elements with the white-space\n   * CSS property.\n   */\n  const trimStart: TrimStartRule = (() => {\n    if (whiteSpaceRule !== 'normal') return 'collapse';\n    if (\n      !state.inlineFormattingContext ||\n      state.inlineFormattingContext.atStart ||\n      state.inlineFormattingContext.lastHasTrailingWhiteSpace\n    )\n      return 'all';\n\n    return 'collapse';\n  })();\n\n  const trimEnd: TrimEndRule = (() => {\n    if (whiteSpaceRule === 'normal') return 'collapse';\n    if (isLastNonEmptyTextOfInlineFormattingContext(text))\n      return 'single-newline';\n\n    return 'collapse';\n  })();\n\n  const shouldCollapseWhiteSpace: boolean = {\n    normal: true,\n    pre: false,\n    'pre-line': true,\n  }[whiteSpaceRule];\n\n  const whiteSpaceIncludesNewlines = whiteSpaceRule !== 'pre-line';\n\n  const collapsedTextContent = collapseString(textContent || '', {\n    shouldCollapseWhiteSpace,\n    trimEnd,\n    trimStart,\n    whiteSpaceIncludesNewlines,\n  });\n\n  if (state.inlineFormattingContext && shouldCollapseWhiteSpace) {\n    state.inlineFormattingContext.lastHasTrailingWhiteSpace =\n      collapsedTextContent.endsWith(' ');\n  }\n\n  text.textContent = collapsedTextContent;\n};\n","import type { CollapseWhiteSpaceState } from './types';\n\nimport { isHtmlElement } from '../isHtmlElement';\nimport { isHtmlText } from '../isHtmlText';\nimport { collapseWhiteSpaceChildren } from './collapseWhiteSpaceChildren';\nimport { collapseWhiteSpaceElement } from './collapseWhiteSpaceElement';\nimport { collapseWhiteSpaceText } from './collapseWhiteSpaceText';\n\nexport const collapseWhiteSpaceNode = (\n  node: Node,\n  state: CollapseWhiteSpaceState\n) => {\n  if (isHtmlElement(node)) {\n    collapseWhiteSpaceElement(node as HTMLElement, state);\n\n    return;\n  }\n  if (isHtmlText(node)) {\n    collapseWhiteSpaceText(node as Text, state);\n\n    return;\n  }\n\n  collapseWhiteSpaceChildren(node, state);\n};\n","import type { CollapseWhiteSpaceState } from './types';\n\nimport { collapseWhiteSpaceNode } from './collapseWhiteSpaceNode';\n\nexport const collapseWhiteSpaceChildren = (\n  node: Node,\n  state: CollapseWhiteSpaceState\n) => {\n  const childNodes = Array.from(node.childNodes);\n\n  for (const childNode of childNodes) {\n    collapseWhiteSpaceNode(childNode, state);\n  }\n};\n","import type { WhiteSpaceRule } from './types';\n\nexport const inferWhiteSpaceRule = (\n  element: HTMLElement\n): WhiteSpaceRule | null => {\n  const whiteSpaceProperty = element.style.whiteSpace;\n\n  switch (whiteSpaceProperty) {\n    case 'normal':\n    case 'nowrap': {\n      return 'normal';\n    }\n    case 'pre':\n    case 'pre-wrap':\n    case 'break-spaces': {\n      return 'pre';\n    }\n    case 'pre-line': {\n      return 'pre-line';\n    }\n  }\n\n  if (element.tagName === 'PRE') {\n    return 'pre';\n  }\n  if (whiteSpaceProperty === 'initial') {\n    return 'normal';\n  }\n\n  return null;\n};\n","import type { CollapseWhiteSpaceState } from './types';\n\nimport { isHtmlInlineElement } from '../isHtmlInlineElement';\nimport { collapseWhiteSpaceChildren } from './collapseWhiteSpaceChildren';\nimport { inferWhiteSpaceRule } from './inferWhiteSpaceRule';\nimport { endInlineFormattingContext } from './stateTransforms';\n\n/**\n * Note: We do not want to start an inline formatting context until we encounter\n * a text node.\n */\nexport const collapseWhiteSpaceElement = (\n  element: HTMLElement,\n  state: CollapseWhiteSpaceState\n) => {\n  const isInlineElement = isHtmlInlineElement(element);\n  const previousWhiteSpaceRule = state.whiteSpaceRule;\n  const inferredWhiteSpaceRule = inferWhiteSpaceRule(element);\n\n  if (inferredWhiteSpaceRule) {\n    state.whiteSpaceRule = inferredWhiteSpaceRule;\n  }\n  // End any existing inline formatting context\n  if (!isInlineElement) {\n    endInlineFormattingContext(state);\n  }\n\n  collapseWhiteSpaceChildren(element, state);\n\n  // Do not let inline formatting context break out of block elements\n  if (!isInlineElement) {\n    endInlineFormattingContext(state);\n  }\n\n  // Restore previous whiteSpaceRule\n  state.whiteSpaceRule = previousWhiteSpaceRule;\n};\n","import type { CollapseWhiteSpaceState } from './types';\n\nimport { collapseWhiteSpaceElement } from './collapseWhiteSpaceElement';\n\n// Entrypoint\nexport const collapseWhiteSpace = (element: HTMLElement) => {\n  const clonedElement = element.cloneNode(true) as HTMLElement;\n\n  // Mutable state object\n  const state: CollapseWhiteSpaceState = {\n    inlineFormattingContext: null,\n    whiteSpaceRule: 'normal',\n  };\n\n  collapseWhiteSpaceElement(clonedElement, state);\n\n  return clonedElement;\n};\n","import type { EDescendant, Value } from '@udecode/slate';\n\nimport { jsx } from 'slate-hyperscript';\n\nimport type { PlateEditor } from '../../../types/PlateEditor';\n\nimport { deserializeHtmlNodeChildren } from './deserializeHtmlNodeChildren';\n\njsx;\n\n/** Deserialize HTML body element to Fragment. */\nexport const htmlBodyToFragment = <V extends Value>(\n  editor: PlateEditor<V>,\n  element: HTMLElement\n): EDescendant<V>[] | undefined => {\n  if (element.nodeName === 'BODY') {\n    return jsx(\n      'fragment',\n      {},\n      deserializeHtmlNodeChildren(editor, element)\n    ) as EDescendant<V>[];\n  }\n};\n","import type { EDescendant, Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../../../types/PlateEditor';\nimport type { DeserializeHtmlChildren } from '../types';\n\nimport { deserializeHtmlNode } from './deserializeHtmlNode';\n\nexport const deserializeHtmlNodeChildren = <V extends Value>(\n  editor: PlateEditor<V>,\n  node: ChildNode | HTMLElement\n) =>\n  Array.from(node.childNodes).flatMap(\n    deserializeHtmlNode(editor)\n  ) as DeserializeHtmlChildren<EDescendant<V>>[];\n","/** Deserialize HTML to break line. */\nexport const htmlBrToNewLine = (node: ChildNode | HTMLElement) => {\n  if (node.nodeName === 'BR') {\n    return '\\n';\n  }\n};\n","import type { EDescendant, TDescendant, Value } from '@udecode/slate';\n\nimport { jsx } from 'slate-hyperscript';\n\nimport type { PlateEditor } from '../../../types/PlateEditor';\n\nimport { deserializeHtmlNodeChildren } from './deserializeHtmlNodeChildren';\nimport { pipeDeserializeHtmlElement } from './pipeDeserializeHtmlElement';\n\n/** Deserialize HTML to Element. */\nexport const htmlElementToElement = <V extends Value>(\n  editor: PlateEditor<V>,\n  element: HTMLElement\n) => {\n  const deserialized = pipeDeserializeHtmlElement(editor, element);\n\n  if (deserialized) {\n    const { node, withoutChildren } = deserialized;\n\n    let descendants =\n      node.children ??\n      (deserializeHtmlNodeChildren(editor, element) as TDescendant[]);\n\n    if (descendants.length === 0 || withoutChildren) {\n      descendants = [{ text: '' }];\n    }\n\n    return jsx('element', node, descendants) as EDescendant<V>;\n  }\n};\n","import type { Value } from '@udecode/slate';\n\nimport { type AnyObject, isDefined } from '@udecode/utils';\nimport castArray from 'lodash/castArray.js';\n\nimport type { Nullable } from '../../../types';\nimport type { PlateEditor } from '../../../types/PlateEditor';\nimport type { DeserializeHtml } from '../../../types/plugin/DeserializeHtml';\nimport type { WithPlatePlugin } from '../../../types/plugin/PlatePlugin';\n\nimport { getInjectedPlugins } from '../../../utils/getInjectedPlugins';\n\n/** Get a deserializer by type, node names, class names and styles. */\nexport const pluginDeserializeHtml = <V extends Value>(\n  editor: PlateEditor<V>,\n  plugin: WithPlatePlugin<{}, V>,\n  {\n    deserializeLeaf,\n    element: el,\n  }: { deserializeLeaf?: boolean; element: HTMLElement }\n): ({ node: AnyObject } & Nullable<DeserializeHtml>) | undefined => {\n  const {\n    deserializeHtml,\n    isElement: isElementRoot,\n    isLeaf: isLeafRoot,\n    type,\n  } = plugin;\n\n  if (!deserializeHtml) return;\n\n  const {\n    attributeNames,\n    isElement: isElementRule,\n    isLeaf: isLeafRule,\n    query,\n    rules,\n  } = deserializeHtml;\n  let { getNode } = deserializeHtml;\n\n  const isElement = isElementRule || isElementRoot;\n  const isLeaf = isLeafRule || isLeafRoot;\n\n  if (!deserializeLeaf && !isElement) {\n    return;\n  }\n  if (deserializeLeaf && !isLeaf) {\n    return;\n  }\n  if (rules) {\n    const isValid = rules.some(\n      ({ validAttribute, validClassName, validNodeName = '*', validStyle }) => {\n        if (validNodeName) {\n          const validNodeNames = castArray<string>(validNodeName);\n\n          // Ignore if el nodeName is not included in rule validNodeNames (except *).\n          if (\n            validNodeNames.length > 0 &&\n            !validNodeNames.includes(el.nodeName) &&\n            validNodeName !== '*'\n          )\n            return false;\n        }\n        // Ignore if the rule className is not in el class list.\n        if (validClassName && !el.classList.contains(validClassName))\n          return false;\n        if (validStyle) {\n          for (const [key, value] of Object.entries(validStyle)) {\n            const values = castArray<string>(value);\n\n            // Ignore if el style value is not included in rule style values (except *)\n            if (!values.includes((el.style as any)[key]) && value !== '*')\n              return;\n            // Ignore if el style value is falsy (for value *)\n            if (value === '*' && !(el.style as any)[key]) return;\n\n            const defaultNodeValue = plugin.inject.props?.defaultNodeValue;\n\n            // Ignore if the style value = plugin.inject.props.defaultNodeValue\n            if (\n              defaultNodeValue &&\n              defaultNodeValue === (el.style as any)[key]\n            ) {\n              return false;\n            }\n          }\n        }\n        if (validAttribute) {\n          if (typeof validAttribute === 'string') {\n            if (!el.getAttributeNames().includes(validAttribute)) return false;\n          } else {\n            for (const [attributeName, attributeValue] of Object.entries(\n              validAttribute\n            )) {\n              const attributeValues = castArray<string>(attributeValue);\n              const elAttribute = el.getAttribute(attributeName);\n\n              if (\n                !isDefined(elAttribute) ||\n                !attributeValues.includes(elAttribute)\n              )\n                return false;\n            }\n          }\n        }\n\n        return true;\n      }\n    );\n\n    if (!isValid) return;\n  }\n  if (query && !query(el)) {\n    return;\n  }\n  if (!getNode) {\n    if (isElement) {\n      getNode = () => ({ type });\n    } else if (isLeaf) {\n      getNode = () => ({ [type]: true });\n    } else {\n      return;\n    }\n  }\n\n  let node = getNode(el, {}) ?? {};\n\n  if (Object.keys(node).length === 0) return;\n\n  const injectedPlugins = getInjectedPlugins<{}, V>(editor, plugin);\n\n  injectedPlugins.forEach((injectedPlugin) => {\n    const res = injectedPlugin.deserializeHtml?.getNode?.(el, node);\n\n    if (res) {\n      node = {\n        ...node,\n        ...res,\n      };\n    }\n  });\n\n  if (attributeNames) {\n    const elementAttributes = {};\n\n    const elementAttributeNames = el.getAttributeNames();\n\n    for (const elementAttributeName of elementAttributeNames) {\n      if (attributeNames.includes(elementAttributeName)) {\n        (elementAttributes as any)[elementAttributeName] =\n          el.getAttribute(elementAttributeName);\n      }\n    }\n\n    if (Object.keys(elementAttributes).length > 0) {\n      node.attributes = elementAttributes;\n    }\n  }\n\n  return { ...deserializeHtml, node };\n};\n","import type { Value } from '@udecode/slate';\nimport type { AnyObject } from '@udecode/utils';\n\nimport type { DeserializeHtml, PlateEditor } from '../../../types';\nimport type { Nullable } from '../../../types/misc/Nullable';\n\nimport { pluginDeserializeHtml } from './pluginDeserializeHtml';\n\nexport const pipeDeserializeHtmlElement = <V extends Value>(\n  editor: PlateEditor<V>,\n  element: HTMLElement\n) => {\n  let result: ({ node: AnyObject } & Nullable<DeserializeHtml>) | undefined;\n\n  [...editor.plugins].reverse().some((plugin) => {\n    result = pluginDeserializeHtml(editor, plugin, { element });\n\n    return !!result;\n  });\n\n  return result;\n};\n","import {\n  type EDescendant,\n  type TDescendant,\n  type Value,\n  isElement,\n  isText,\n} from '@udecode/slate';\nimport { jsx } from 'slate-hyperscript';\n\nimport type { PlateEditor } from '../../../types';\n\nimport { mergeDeepToNodes } from '../../../utils';\nimport { deserializeHtmlNodeChildren } from './deserializeHtmlNodeChildren';\nimport { pipeDeserializeHtmlLeaf } from './pipeDeserializeHtmlLeaf';\n\n/**\n * Deserialize HTML to TDescendant[] with marks on Text. Build the leaf from the\n * leaf deserializers of each plugin.\n */\nexport const htmlElementToLeaf = <V extends Value>(\n  editor: PlateEditor<V>,\n  element: HTMLElement\n) => {\n  const node = pipeDeserializeHtmlLeaf(editor, element);\n\n  return deserializeHtmlNodeChildren(editor, element).reduce(\n    (arr: TDescendant[], child) => {\n      if (!child) return arr;\n      if (isElement(child)) {\n        if (Object.keys(node).length > 0) {\n          mergeDeepToNodes({\n            node: child,\n            query: {\n              filter: ([n]) => isText(n),\n            },\n            source: node,\n          });\n        }\n\n        arr.push(child);\n      } else {\n        const attributes = { ...node };\n\n        // attributes should not override child attributes\n        if (isText(child) && child.text) {\n          Object.keys(attributes).forEach((key) => {\n            if (attributes[key] && child[key]) {\n              attributes[key] = child[key];\n            }\n          });\n        }\n\n        arr.push(jsx('text', attributes, child) as any);\n      }\n\n      return arr;\n    },\n    []\n  ) as EDescendant<V>[];\n};\n","import type { Value } from '@udecode/slate';\nimport type { AnyObject } from '@udecode/utils';\n\nimport type { PlateEditor } from '../../../types/PlateEditor';\n\nimport { pluginDeserializeHtml } from './pluginDeserializeHtml';\n\nexport const pipeDeserializeHtmlLeaf = <V extends Value>(\n  editor: PlateEditor<V>,\n  element: HTMLElement\n) => {\n  let node: AnyObject = {};\n\n  [...editor.plugins].reverse().forEach((plugin) => {\n    const deserialized = pluginDeserializeHtml(editor, plugin, {\n      deserializeLeaf: true,\n      element,\n    });\n\n    if (!deserialized) return;\n\n    node = { ...node, ...deserialized.node };\n  });\n\n  return node;\n};\n","/** Deserialize HTML text node to text. */\nimport { isHtmlText } from './isHtmlText';\n\nexport const htmlTextNodeToString = (node: ChildNode | HTMLElement) => {\n  if (isHtmlText(node)) {\n    return node.textContent || '';\n  }\n};\n","import type { EDescendant, Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../../../types/PlateEditor';\nimport type { DeserializeHtmlNodeReturnType } from '../types';\n\nimport { htmlBodyToFragment } from './htmlBodyToFragment';\nimport { htmlBrToNewLine } from './htmlBrToNewLine';\nimport { htmlElementToElement } from './htmlElementToElement';\nimport { htmlElementToLeaf } from './htmlElementToLeaf';\nimport { htmlTextNodeToString } from './htmlTextNodeToString';\nimport { isHtmlElement } from './isHtmlElement';\n\n/** Deserialize HTML element or child node. */\nexport const deserializeHtmlNode =\n  <V extends Value>(editor: PlateEditor<V>) =>\n  (\n    node: ChildNode | HTMLElement\n  ): DeserializeHtmlNodeReturnType<EDescendant<V>> => {\n    const textNode = htmlTextNodeToString(node);\n\n    if (textNode) return textNode;\n    if (!isHtmlElement(node)) return null;\n\n    // break line\n    const breakLine = htmlBrToNewLine(node);\n\n    if (breakLine) return breakLine;\n\n    // body\n    const fragment = htmlBodyToFragment(editor, node as HTMLElement);\n\n    if (fragment) return fragment;\n\n    // element\n    const element = htmlElementToElement(editor, node as HTMLElement);\n\n    if (element) return element;\n\n    // leaf\n    return htmlElementToLeaf(editor, node as HTMLElement);\n  };\n","import type { EDescendant, Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../../../types/PlateEditor';\nimport type { DeserializeHtmlNodeReturnType } from '../types';\n\nimport { deserializeHtmlNode } from './deserializeHtmlNode';\n\n/** Deserialize HTML element to fragment. */\nexport const deserializeHtmlElement = <V extends Value>(\n  editor: PlateEditor<V>,\n  element: HTMLElement\n): DeserializeHtmlNodeReturnType<EDescendant<V>> => {\n  return deserializeHtmlNode(editor)(element);\n};\n","/** Convert HTML string into HTML element. */\nexport const htmlStringToDOMNode = (rawHtml: string) => {\n  const node = document.createElement('body');\n  node.innerHTML = rawHtml;\n\n  return node;\n};\n","import type { EDescendant, Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../../../types';\n\nimport { normalizeDescendantsToDocumentFragment } from '../../../utils/normalizeDescendantsToDocumentFragment';\nimport { collapseWhiteSpace } from './collapse-white-space';\nimport { deserializeHtmlElement } from './deserializeHtmlElement';\nimport { htmlStringToDOMNode } from './htmlStringToDOMNode';\n\n/** Deserialize HTML element to a valid document fragment. */\nexport const deserializeHtml = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    collapseWhiteSpace: shouldCollapseWhiteSpace = true,\n    element,\n  }: {\n    collapseWhiteSpace?: boolean;\n    element: HTMLElement | string;\n  }\n): EDescendant<V>[] => {\n  // for serializer\n  if (typeof element === 'string') {\n    element = htmlStringToDOMNode(element);\n  }\n  if (shouldCollapseWhiteSpace) {\n    element = collapseWhiteSpace(element);\n  }\n\n  const fragment = deserializeHtmlElement(editor, element) as EDescendant<V>[];\n\n  return normalizeDescendantsToDocumentFragment(editor, {\n    descendants: fragment,\n  });\n};\n","export const parseHtmlDocument = (html: string) => {\n  return new DOMParser().parseFromString(html, 'text/html');\n};\n","import { createPluginFactory } from '../../utils/createPluginFactory';\nimport { deserializeHtml } from './utils/deserializeHtml';\nimport { parseHtmlDocument } from './utils/parseHtmlDocument';\n\nexport const KEY_DESERIALIZE_HTML = 'deserializeHtml';\n\n/**\n * Enables support for deserializing inserted content from HTML format to Slate\n * format.\n */\nexport const createDeserializeHtmlPlugin = createPluginFactory({\n  key: KEY_DESERIALIZE_HTML,\n  then: (editor) => ({\n    editor: {\n      insertData: {\n        format: 'text/html',\n        getFragment: ({ data }) => {\n          const document = parseHtmlDocument(data);\n\n          return deserializeHtml(editor, {\n            element: document.body,\n          });\n        },\n      },\n    },\n  }),\n});\n","type Callback = (node: Node) => boolean;\n\n/**\n * Depth-first pre-order tree traverse the given HTML node and calls the given\n * callback for each node. see:\n * https://en.wikipedia.org/wiki/Tree_traversal#Pre-order_(NLR)\n *\n * @param callback Returns a boolean indicating whether traversal should be\n *   continued\n */\nexport const traverseHtmlNode = (node: Node, callback: Callback): void => {\n  const keepTraversing = callback(node);\n\n  if (!keepTraversing) {\n    return;\n  }\n\n  let child = node.firstChild;\n\n  while (child) {\n    const currentChild = child;\n    const previousChild = child.previousSibling;\n    child = child.nextSibling;\n\n    traverseHtmlNode(currentChild, callback);\n\n    if (\n      // An unwrap was made. Need to compute the next child again.\n      !currentChild.previousSibling &&\n      !currentChild.nextSibling &&\n      !currentChild.parentNode &&\n      child &&\n      previousChild !== child.previousSibling &&\n      child.parentNode\n    ) {\n      child = previousChild ? previousChild.nextSibling : node.firstChild;\n    } else if (\n      // A list was created. Need to compute the next child again.\n      !currentChild.previousSibling &&\n      !currentChild.nextSibling &&\n      !currentChild.parentNode &&\n      child &&\n      !child.previousSibling &&\n      !child.nextSibling &&\n      !child.parentNode\n    ) {\n      if (previousChild) {\n        child = previousChild.nextSibling\n          ? previousChild.nextSibling.nextSibling\n          : null;\n      } else if (node.firstChild) {\n        child = node.firstChild.nextSibling;\n      }\n    }\n  }\n};\n","import { isHtmlElement } from './isHtmlElement';\nimport { traverseHtmlNode } from './traverseHtmlNode';\n\ntype Callback = (node: Element) => boolean;\n\n/**\n * Traverse the HTML elements of the given HTML node.\n *\n * @param rootNode The root HTML node to traverse.\n * @param callback The callback to call for each HTML element.\n */\nexport const traverseHtmlElements = (\n  rootNode: Node,\n  callback: Callback\n): void => {\n  traverseHtmlNode(rootNode, (node) => {\n    if (!isHtmlElement(node)) {\n      return true;\n    }\n\n    return callback(node);\n  });\n};\n","import { LINE_FEED } from '../constants';\nimport { traverseHtmlElements } from './traverseHtmlElements';\n\n/** Replace BR elements with line feeds. */\nexport const cleanHtmlBrElements = (rootNode: Node): void => {\n  traverseHtmlElements(rootNode, (element) => {\n    if (element.tagName !== 'BR') {\n      return true;\n    }\n\n    const replacementTextNode = document.createTextNode(LINE_FEED);\n\n    if (element.parentElement) {\n      element.parentElement.replaceChild(replacementTextNode, element);\n    }\n\n    return false;\n  });\n};\n","/** Replace \\r\\n and \\r with \\n */\nexport const cleanHtmlCrLf = (html: string): string => {\n  return html.replaceAll(/\\r\\n|\\r/g, '\\n');\n};\n","import { traverseHtmlElements } from './traverseHtmlElements';\n\nconst ALLOWED_EMPTY_ELEMENTS = new Set(['BR', 'IMG', 'TH', 'TD']);\n\nconst isEmpty = (element: Element): boolean => {\n  return (\n    !ALLOWED_EMPTY_ELEMENTS.has(element.nodeName) && !element.innerHTML.trim()\n  );\n};\n\nconst removeIfEmpty = (element: Element): void => {\n  if (isEmpty(element)) {\n    const { parentElement } = element;\n\n    element.remove();\n\n    if (parentElement) {\n      removeIfEmpty(parentElement);\n    }\n  }\n};\n\n/** Remove empty elements from rootNode. Allowed empty elements: BR, IMG. */\nexport const cleanHtmlEmptyElements = (rootNode: Node): void => {\n  traverseHtmlElements(rootNode, (element) => {\n    removeIfEmpty(element);\n\n    return true;\n  });\n};\n","/**\n * Replace `element` tag name by `tagName`. Attributes, innerHTML and parent\n * relationship is kept.\n */\nexport const replaceTagName = (element: Element, tagName: string): Element => {\n  const newElement = document.createElement(tagName);\n\n  newElement.innerHTML = element.innerHTML;\n\n  for (const { name } of element.attributes) {\n    const value = element.getAttribute(name);\n\n    if (value) {\n      newElement.setAttribute(name, value);\n    }\n  }\n\n  if (element.parentNode) {\n    element.parentNode.replaceChild(newElement, element);\n  }\n\n  return newElement;\n};\n","import { replaceTagName } from './replaceTagName';\nimport { traverseHtmlElements } from './traverseHtmlElements';\n\n/**\n * Replace FONT elements with SPAN elements if there is textContent (remove\n * otherwise).\n */\nexport const cleanHtmlFontElements = (rootNode: Node): void => {\n  traverseHtmlElements(rootNode, (element) => {\n    if (element.tagName === 'FONT') {\n      if (element.textContent) {\n        replaceTagName(element, 'span');\n      } else {\n        element.remove();\n      }\n    }\n\n    return true;\n  });\n};\n","/** If href starts with '#'. */\nexport const isHtmlFragmentHref = (href: string): boolean =>\n  href.startsWith('#');\n","/** Unwrap the given HTML element. */\nexport const unwrapHtmlElement = (element: Element): void => {\n  element.outerHTML = element.innerHTML;\n};\n","import { isHtmlFragmentHref } from './isHtmlFragmentHref';\nimport { traverseHtmlElements } from './traverseHtmlElements';\nimport { unwrapHtmlElement } from './unwrapHtmlElement';\n\n/** Remove fragment hrefs and spans without inner text. */\nexport const cleanHtmlLinkElements = (rootNode: Node): void => {\n  traverseHtmlElements(rootNode, (element) => {\n    if (element.tagName !== 'A') {\n      return true;\n    }\n\n    const href = element.getAttribute('href');\n\n    if (!href || isHtmlFragmentHref(href)) {\n      unwrapHtmlElement(element);\n    }\n    if (href && element.querySelector('img')) {\n      for (const span of element.querySelectorAll('span')) {\n        if (!span.textContent) {\n          unwrapHtmlElement(span);\n        }\n      }\n    }\n\n    return true;\n  });\n};\n","import { isHtmlText } from './isHtmlText';\nimport { traverseHtmlNode } from './traverseHtmlNode';\n\ntype Callback = (node: Text) => boolean;\n\nexport const traverseHtmlTexts = (rootNode: Node, callback: Callback): void => {\n  traverseHtmlNode(rootNode, (node) => {\n    if (!isHtmlText(node)) {\n      return true;\n    }\n\n    return callback(node);\n  });\n};\n","import {\n  CARRIAGE_RETURN,\n  LINE_FEED,\n  NO_BREAK_SPACE,\n  SPACE,\n} from '../constants';\nimport { traverseHtmlTexts } from './traverseHtmlTexts';\n\nexport const cleanHtmlTextNodes = (rootNode: Node): void => {\n  traverseHtmlTexts(rootNode, (textNode) => {\n    if (\n      /^\\n\\s*$/.test(textNode.data) &&\n      (textNode.previousElementSibling || textNode.nextElementSibling)\n    ) {\n      textNode.remove();\n\n      return true;\n    }\n\n    textNode.data = textNode.data.replaceAll(/\\n\\s*/g, '\\n');\n\n    if (\n      textNode.data.includes(CARRIAGE_RETURN) ||\n      textNode.data.includes(LINE_FEED) ||\n      textNode.data.includes(NO_BREAK_SPACE)\n    ) {\n      const hasSpace = textNode.data.includes(SPACE);\n      const hasNonWhitespace = /\\S/.test(textNode.data);\n      const hasLineFeed = textNode.data.includes(LINE_FEED);\n\n      if (!(hasSpace || hasNonWhitespace) && !hasLineFeed) {\n        if (textNode.data === NO_BREAK_SPACE) {\n          textNode.data = SPACE;\n\n          return true;\n        }\n\n        textNode.remove();\n\n        return true;\n      }\n      if (\n        textNode.previousSibling &&\n        textNode.previousSibling.nodeName === 'BR' &&\n        textNode.parentElement\n      ) {\n        textNode.previousSibling.remove();\n\n        const matches = textNode.data.match(/^[\\n\\r]+/);\n        const offset = matches ? matches[0].length : 0;\n\n        textNode.data = textNode.data\n          .slice(Math.max(0, offset))\n          .replaceAll(new RegExp(LINE_FEED, 'g'), SPACE)\n          .replaceAll(new RegExp(CARRIAGE_RETURN, 'g'), SPACE);\n        textNode.data = `\\n${textNode.data}`;\n      } else {\n        textNode.data = textNode.data\n          .replaceAll(new RegExp(LINE_FEED, 'g'), SPACE)\n          .replaceAll(new RegExp(CARRIAGE_RETURN, 'g'), SPACE);\n      }\n    }\n\n    return true;\n  });\n};\n","export const isHtmlTable = (element: Element) => element.nodeName === 'TABLE';\n","import { isHtmlBlockElement } from './isHtmlBlockElement';\nimport { isHtmlTable } from './isHtmlTable';\nimport { traverseHtmlElements } from './traverseHtmlElements';\n\n/**\n * Set HTML blocks mark styles to a new child span element if any. This allows\n * Plate to use block marks.\n */\nexport const copyBlockMarksToSpanChild = (rootNode: Node) => {\n  traverseHtmlElements(rootNode, (element) => {\n    const el = element as HTMLElement;\n\n    const styleAttribute = element.getAttribute('style');\n\n    if (!styleAttribute) return true;\n    if (isHtmlBlockElement(el) && !isHtmlTable(el)) {\n      const {\n        style: {\n          backgroundColor,\n          color,\n          fontFamily,\n          fontSize,\n          fontStyle,\n          fontWeight,\n          textDecoration,\n        },\n      } = el;\n\n      if (\n        backgroundColor ||\n        color ||\n        fontFamily ||\n        fontSize ||\n        fontStyle ||\n        fontWeight ||\n        textDecoration\n      ) {\n        const span = document.createElement('span');\n\n        if (!['inherit', 'initial'].includes(color)) {\n          span.style.color = color;\n        }\n\n        span.style.fontFamily = fontFamily;\n        span.style.fontSize = fontSize;\n\n        if (!['inherit', 'initial', 'normal'].includes(color)) {\n          span.style.fontStyle = fontStyle;\n        }\n        if (![400, 'normal'].includes(fontWeight)) {\n          span.style.fontWeight = fontWeight;\n        }\n\n        span.style.textDecoration = textDecoration;\n\n        span.innerHTML = el.innerHTML;\n        element.innerHTML = span.outerHTML;\n      }\n    }\n\n    return true;\n  });\n};\n","import { traverseHtmlElements } from './traverseHtmlElements';\n\n/**\n * Find the first HTML element that matches the given selector.\n *\n * @param rootNode\n * @param predicate\n */\nexport const findHtmlElement = (\n  rootNode: Node,\n  predicate: (node: HTMLElement) => boolean\n) => {\n  let res: Node | null = null;\n\n  traverseHtmlElements(rootNode, (node) => {\n    if (predicate(node as HTMLElement)) {\n      res = node;\n\n      return false;\n    }\n\n    return true;\n  });\n\n  return res;\n};\n\nexport const someHtmlElement = (\n  rootNode: Node,\n  predicate: (node: HTMLElement) => boolean\n) => {\n  return !!findHtmlElement(rootNode, predicate);\n};\n","const acceptNode = () => NodeFilter.FILTER_ACCEPT;\n\nexport const getHtmlComments = (node: Node): string[] => {\n  const comments: string[] = [];\n  const iterator = document.createNodeIterator(node, NodeFilter.SHOW_COMMENT, {\n    acceptNode,\n  });\n  let currentNode = iterator.nextNode();\n\n  while (currentNode) {\n    if (currentNode.nodeValue) {\n      comments.push(currentNode.nodeValue);\n    }\n\n    currentNode = iterator.nextNode();\n  }\n\n  return comments;\n};\n","export const isHtmlComment = (node: Node): node is Comment =>\n  node.nodeType === Node.COMMENT_NODE;\n","export const isOlSymbol = (symbol: string): boolean => {\n  return /[\\da-np-z]\\S/.test(symbol.toLowerCase());\n};\n","import { parseHtmlDocument } from './parseHtmlDocument';\n\nexport const parseHtmlElement = (html: string) => {\n  const { body } = parseHtmlDocument(html);\n\n  return body.firstElementChild as HTMLElement;\n};\n","import { ZERO_WIDTH_SPACE } from '../constants';\n\n/** Trim the html and remove zero width spaces, then wrap it with a body element. */\nexport const postCleanHtml = (html: string): string => {\n  const cleanHtml = html\n    .trim()\n    .replaceAll(new RegExp(ZERO_WIDTH_SPACE, 'g'), '');\n\n  return `<body>${cleanHtml}</body>`;\n};\n","/** Remove string before <html */\nconst removeBeforeHtml = (html: string): string => {\n  const index = html.indexOf('<html');\n\n  if (index === -1) {\n    return html;\n  }\n\n  return html.slice(Math.max(0, index));\n};\n\n/** Remove string after </html> */\nconst removeAfterHtml = (html: string): string => {\n  const index = html.lastIndexOf('</html>');\n\n  if (index === -1) {\n    return html;\n  }\n\n  return html.slice(0, Math.max(0, index + '</html>'.length));\n};\n\n/** Remove string before <html and after </html> */\nexport const removeHtmlSurroundings = (html: string): string => {\n  return removeBeforeHtml(removeAfterHtml(html));\n};\n","import { cleanHtmlCrLf } from './cleanHtmlCrLf';\nimport { removeHtmlSurroundings } from './removeHtmlSurroundings';\n\nconst cleaners = [removeHtmlSurroundings, cleanHtmlCrLf];\n\n/** Remove HTML surroundings and clean HTML from CR/LF */\nexport const preCleanHtml = (html: string): string => {\n  return cleaners.reduce((result, clean) => clean(result), html);\n};\n","import { isHtmlComment } from './isHtmlComment';\nimport { traverseHtmlNode } from './traverseHtmlNode';\n\ntype Callback = (node: Comment) => boolean;\n\n/** Traverse HTML comments. */\nexport const traverseHtmlComments = (\n  rootNode: Node,\n  callback: Callback\n): void => {\n  traverseHtmlNode(rootNode, (node) => {\n    if (!isHtmlComment(node)) {\n      return true;\n    }\n\n    return callback(node);\n  });\n};\n","import { isHtmlComment } from './isHtmlComment';\nimport { traverseHtmlComments } from './traverseHtmlComments';\n\n/** Removes HTML nodes between HTML comments. */\nexport const removeHtmlNodesBetweenComments = (\n  rootNode: Node,\n  start: string,\n  end: string\n): void => {\n  const isClosingComment = (node: Node) =>\n    isHtmlComment(node) && node.data === end;\n\n  traverseHtmlComments(rootNode, (comment) => {\n    if (comment.data === start) {\n      let node = comment.nextSibling;\n\n      comment.remove();\n\n      while (node && !isClosingComment(node)) {\n        const { nextSibling } = node;\n        node.remove();\n        node = nextSibling;\n      }\n\n      if (node && isClosingComment(node)) {\n        node.remove();\n      }\n    }\n\n    return true;\n  });\n};\n","import type { Value } from '@udecode/slate';\n\nimport type { PlateEditor } from '../shared/types';\n\nimport { createPluginFactory } from '../shared/utils/createPluginFactory';\n\nconst noop = (returnValue?: any) => (() => returnValue) as any;\n\nexport const withReact = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n>(\n  editor: E\n) => {\n  editor.hasEditableTarget = noop(false);\n  editor.hasRange = noop(false);\n  editor.hasSelectableTarget = noop(false);\n  editor.hasTarget = noop(false);\n  editor.insertData = noop();\n  editor.insertFragmentData = noop();\n  editor.insertTextData = noop(false);\n  editor.isTargetInsideNonReadonlyVoid = noop(false);\n  editor.setFragmentData = noop();\n\n  return editor;\n};\n\n/** @see {@link withReact} with noop methods for server-side support. */\nexport const createReactPlugin = createPluginFactory({\n  key: 'react',\n  withOverrides: withReact,\n});\n","import type { TEditor, Value } from '@udecode/slate';\n\nimport type { WithPlateOptions } from '../client';\nimport type { PlateEditor } from '../shared/types/PlateEditor';\n\nimport { resetEditor } from '../shared/transforms';\nimport { setPlatePlugins } from './setPlatePlugins';\n\nconst shouldHaveBeenOverridden = (fnName: string) => () => {\n  console.warn(\n    `editor.${fnName} should have been overriden but was not. Please report this issue here: https://github.com/udecode/plate/issues`\n  );\n};\n\n/** `withPlate` with server-side support. */\nexport const withPlate = <\n  V extends Value = Value,\n  E extends TEditor<V> = TEditor<V>,\n>(\n  e: E,\n  {\n    disableCorePlugins,\n    id,\n    maxLength,\n    plugins = [],\n  }: WithPlateOptions<V, E & PlateEditor<V>> = {}\n): E & PlateEditor<V> => {\n  let editor = e as any as E & PlateEditor<V>;\n\n  // Override incremental id generated by slate\n  editor.id = id ?? editor.id;\n  editor.prevSelection = null;\n  editor.isFallback = false;\n  editor.currentKeyboardEvent = null;\n\n  // Editor methods\n  editor.reset = () => resetEditor(editor);\n  editor.redecorate = () => shouldHaveBeenOverridden('redecorate');\n  editor.plate = {\n    get set() {\n      shouldHaveBeenOverridden('plate.set');\n\n      return null as any;\n    },\n  };\n\n  if (!editor.key) {\n    editor.key = Math.random();\n  }\n\n  setPlatePlugins<V>(editor, {\n    disableCorePlugins,\n    maxLength,\n    plugins: plugins as any,\n  });\n\n  // withOverrides\n  editor.plugins.forEach((plugin) => {\n    if (plugin.withOverrides) {\n      editor = plugin.withOverrides(editor, plugin) as any;\n    }\n  });\n\n  return editor;\n};\n","import React from 'react';\n\nimport type { Value } from '@udecode/slate';\n\nimport type { PlateRenderLeafProps } from '../types/PlateRenderLeafProps';\n\nexport function DefaultLeaf<V extends Value>({\n  attributes,\n  children,\n  editor,\n  leaf,\n  nodeProps,\n  text,\n  ...props\n}: PlateRenderLeafProps<V>) {\n  return (\n    <span {...attributes} {...props}>\n      {children}\n    </span>\n  );\n}\n","import type React from 'react';\n\nimport type { TSelection, Value } from '@udecode/slate';\n\nimport type { PlateId } from '../../client';\nimport type { PlateEditor } from './PlateEditor';\nimport type { Nullable } from './misc/Nullable';\nimport type {\n  PlatePlugin,\n  PluginOptions,\n  WithPlatePlugin,\n} from './plugin/PlatePlugin';\nimport type { TEditableProps } from './slate-react/TEditableProps';\n\nexport type PlateChangeKey =\n  | 'versionDecorate'\n  | 'versionEditor'\n  | 'versionSelection';\n\nexport type PlateStoreState<\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>,\n> = {\n  /**\n   * Slate editor reference.\n   *\n   * @default createPlateFallbackEditor()\n   */\n  editor: E;\n\n  /**\n   * A unique id used as a provider scope. Use it if you have multiple `Plate`\n   * in the same React tree.\n   *\n   * @default random id\n   */\n  id: PlateId;\n\n  /** Flattened plugins. */\n  plugins: WithPlatePlugin<PluginOptions, V, E>[];\n\n  /** Plugins prop passed to `Plate`. */\n  rawPlugins: PlatePlugin<PluginOptions, V, E>[];\n\n  /**\n   * Value of the editor.\n   *\n   * @default [{ type: 'p'; children: [{ text: '' }] }]\n   */\n  value: V;\n} & Nullable<{\n  decorate: NonNullable<TEditableProps['decorate']>;\n\n  /** Access the editor object using a React ref. */\n  editorRef: React.ForwardedRef<E>;\n\n  /** Whether `Editable` is rendered so slate DOM is resolvable. */\n  isMounted: boolean;\n\n  /** Controlled callback called when the editor state changes. */\n  onChange: (value: V) => void;\n\n  /** Controlled callback called when the editor.selection changes. */\n  onSelectionChange: (selection: TSelection) => void;\n\n  /** Controlled callback called when the editor.children changes. */\n  onValueChange: (value: V) => void;\n\n  /**\n   * Whether the editor is primary. If no editor is active, then PlateController\n   * will use the first-mounted primary editor.\n   *\n   * @default true\n   */\n  primary: boolean;\n\n  // Whether the editor is read-only.\n  readOnly: boolean;\n\n  renderElement: NonNullable<TEditableProps['renderElement']>;\n\n  renderLeaf: NonNullable<TEditableProps['renderLeaf']>;\n\n  /**\n   * Version incremented when calling `redecorate`. This is a dependency of the\n   * `decorate` function.\n   */\n  versionDecorate: number;\n  /** Version incremented on each editor change. */\n  versionEditor: number;\n  /** Version incremented on each editor.selection change. */\n  versionSelection: number;\n}>;\n\n// A list of store keys to be exposed in `editor.plate.set`.\nexport const EXPOSED_STORE_KEYS: (keyof PlateStoreState)[] = [\n  'readOnly',\n  'plugins',\n  'onChange',\n  'decorate',\n  'renderElement',\n  'renderLeaf',\n];\n","import type { DOMHandlers } from '../plugin';\n\nexport const DOM_HANDLERS: (keyof DOMHandlers)[] = [\n  // Clipboard Events\n  'onCopy',\n  'onCopyCapture',\n  'onCut',\n  'onCutCapture',\n  'onPaste',\n  'onPasteCapture',\n\n  // Composition Events\n  'onCompositionEnd',\n  'onCompositionEndCapture',\n  'onCompositionStart',\n  'onCompositionStartCapture',\n  'onCompositionUpdate',\n  'onCompositionUpdateCapture',\n\n  // Focus Events\n  'onFocus',\n  'onFocusCapture',\n  'onBlur',\n  'onBlurCapture',\n\n  // Form Events\n  'onDOMBeforeInput',\n  'onBeforeInput',\n  'onBeforeInputCapture',\n  'onInput',\n  'onInputCapture',\n  'onReset',\n  'onResetCapture',\n  'onSubmit',\n  'onSubmitCapture',\n  'onInvalid',\n  'onInvalidCapture',\n\n  // Image Events\n  'onLoad',\n  'onLoadCapture',\n\n  // Keyboard Events\n  'onKeyDown',\n  'onKeyDownCapture',\n  'onKeyPress',\n  'onKeyPressCapture',\n  'onKeyUp',\n  'onKeyUpCapture',\n\n  // Media Events\n  'onAbort',\n  'onAbortCapture',\n  'onCanPlay',\n  'onCanPlayCapture',\n  'onCanPlayThrough',\n  'onCanPlayThroughCapture',\n  'onDurationChange',\n  'onDurationChangeCapture',\n  'onEmptied',\n  'onEmptiedCapture',\n  'onEncrypted',\n  'onEncryptedCapture',\n  'onEnded',\n  'onEndedCapture',\n  'onLoadedData',\n  'onLoadedDataCapture',\n  'onLoadedMetadata',\n  'onLoadedMetadataCapture',\n  'onLoadStart',\n  'onLoadStartCapture',\n  'onPause',\n  'onPauseCapture',\n  'onPlay',\n  'onPlayCapture',\n  'onPlaying',\n  'onPlayingCapture',\n  'onProgress',\n  'onProgressCapture',\n  'onRateChange',\n  'onRateChangeCapture',\n  'onSeeked',\n  'onSeekedCapture',\n  'onSeeking',\n  'onSeekingCapture',\n  'onStalled',\n  'onStalledCapture',\n  'onSuspend',\n  'onSuspendCapture',\n  'onTimeUpdate',\n  'onTimeUpdateCapture',\n  'onVolumeChange',\n  'onVolumeChangeCapture',\n  'onWaiting',\n  'onWaitingCapture',\n\n  // MouseEvents\n  'onAuxClick',\n  'onAuxClickCapture',\n  'onClick',\n  'onClickCapture',\n  'onContextMenu',\n  'onContextMenuCapture',\n  'onDoubleClick',\n  'onDoubleClickCapture',\n  'onDrag',\n  'onDragCapture',\n  'onDragEnd',\n  'onDragEndCapture',\n  'onDragEnter',\n  'onDragEnterCapture',\n  'onDragExit',\n  'onDragExitCapture',\n  'onDragLeave',\n  'onDragLeaveCapture',\n  'onDragOver',\n  'onDragOverCapture',\n  'onDragStart',\n  'onDragStartCapture',\n  'onDrop',\n  'onDropCapture',\n  'onMouseDown',\n  'onMouseDownCapture',\n  'onMouseEnter',\n  'onMouseLeave',\n  'onMouseMove',\n  'onMouseMoveCapture',\n  'onMouseOut',\n  'onMouseOutCapture',\n  'onMouseOver',\n  'onMouseOverCapture',\n  'onMouseUp',\n  'onMouseUpCapture',\n\n  // Selection Events\n  'onSelect',\n  'onSelectCapture',\n\n  // Touch Events\n  'onTouchCancel',\n  'onTouchCancelCapture',\n  'onTouchEnd',\n  'onTouchEndCapture',\n  'onTouchMove',\n  'onTouchMoveCapture',\n  'onTouchStart',\n  'onTouchStartCapture',\n\n  // Pointer Events\n  'onPointerDown',\n  'onPointerDownCapture',\n  'onPointerMove',\n  'onPointerUp',\n  'onPointerUpCapture',\n  'onPointerCancel',\n  'onPointerCancelCapture',\n  'onPointerEnter',\n  'onPointerLeave',\n  'onPointerOver',\n  'onPointerOverCapture',\n  'onPointerOut',\n  'onPointerOutCapture',\n  'onGotPointerCapture',\n  'onGotPointerCaptureCapture',\n  'onLostPointerCapture',\n  'onLostPointerCaptureCapture',\n\n  // UI Events\n  'onScroll',\n  'onScrollCapture',\n\n  // Wheel Events\n  'onWheel',\n  'onWheelCapture',\n\n  // Animation Events\n  'onAnimationStart',\n  'onAnimationStartCapture',\n  'onAnimationEnd',\n  'onAnimationEndCapture',\n  'onAnimationIteration',\n  'onAnimationIterationCapture',\n\n  // Transition Events\n  'onTransitionEnd',\n  'onTransitionEndCapture',\n];\n"],"mappings":"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,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AACF;","names":["import_slate","defaultsDeep","cloneDeep","import_utils","castArray","import_slate","import_slate","_a","_b","_a","_b","import_slate","import_slate","import_defaultsDeep","import_defaultsDeep","defaultsDeep","merge","keyBy","values","defaultsDeep","import_castArray","castArray","pick","_a","import_merge","merge","import_slate","import_cloneDeep","cloneDeep","isEqual","import_slate","import_clsx","import_utils","import_is_hotkey","React","import_slate_hyperscript","import_utils","import_castArray","deserializeHtml","isElement","_a","castArray","values","import_slate","import_slate_hyperscript","document","import_react","React"]}